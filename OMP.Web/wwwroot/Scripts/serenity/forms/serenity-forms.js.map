{"version":3,"file":"serenity-forms.js","sourceRoot":"","sources":["../../CoreLib/UI/Helpers/ValidationHelper.ts","../../CoreLib/UI/Widgets/TemplatedPanel.ts","../../CoreLib/UI/Helpers/TabsExtensions.ts","../../CoreLib/UI/Widgets/ReflectionOptionsSetter.ts","../../CoreLib/UI/Widgets/PropertyGrid.ts","../../CoreLib/UI/Widgets/PropertyPanel.ts","../../CoreLib/Imports/VueIntegration.ts"],"names":[],"mappings":"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","sourcesContent":["\r\n\r\nnamespace Q {\r\n    let oldShowLabel: (e: HTMLElement, message: string) => void;\r\n\r\n    function validateShowLabel(element: HTMLElement, message: string) {\r\n        oldShowLabel.call(this, element, message);\r\n        this.errorsFor(element).each(function (i: number, e: any) {\r\n\r\n            if ($(element).hasClass('error'))\r\n                $(e).removeClass('checked');\r\n\r\n            $(e).attr('title', $(e).text());\r\n        });\r\n    };\r\n\r\n    function jQueryValidationInitialization() {\r\n\r\n        let p: any = $.validator;\r\n        p = p.prototype;\r\n        oldShowLabel = p.showLabel;\r\n        p.showLabel = validateShowLabel;\r\n\r\n        p.oldfocusInvalid = p.focusInvalid;\r\n        p.focusInvalid = function () {\r\n            if (this.settings.abortHandler)\r\n                this.settings.abortHandler(this);\r\n            this.oldfocusInvalid.call(this);\r\n        };\r\n        p.oldstopRequest = p.focusInvalid;\r\n        p.stopRequest = function (element: any, valid: boolean) {\r\n            let formSubmitted = this.formSubmitted;\r\n            this.oldfocusInvalid.call(this, [element, valid]);\r\n            if (!valid && this.pendingRequest == 0 && formSubmitted && this.settings.abortHandler) {\r\n                this.settings.abortHandler(this);\r\n            }\r\n        };\r\n        p.resetAll = function () {\r\n            this.submitted = {};\r\n            this.prepareForm();\r\n            this.hideErrors();\r\n            this.elements().removeClass(this.settings.errorClass);\r\n        };\r\n    };\r\n\r\n    export function validatorAbortHandler(validator: any) {\r\n        validator.settings.abortHandler = null;\r\n        validator.settings.submitHandler = function () {\r\n            return false;\r\n        };\r\n    };\r\n\r\n    export function validateOptions(options: JQueryValidation.ValidationOptions) {\r\n        var opt = Q.baseValidateOptions();\r\n        delete opt.showErrors;\r\n        return Q.extend(Q.extend(opt, {\r\n            meta: 'v',\r\n            errorPlacement: function (error: any, element: any) {\r\n                let field: any = null;\r\n                let vx = element.attr('data-vx-id');\r\n                if (vx) {\r\n                    field = $('#' + vx);\r\n                    if (!field.length)\r\n                        field = null;\r\n                    else\r\n                        field = field[0];\r\n                }\r\n                if (field == null) {\r\n                    field = element.parents('div.field');\r\n                    if (field.length) {\r\n                        let inner = $('div.vx', field[0]);\r\n                        if (inner.length)\r\n                            field = inner[0];\r\n                    }\r\n                    else\r\n                        field = element.parent();\r\n                }\r\n                error.appendTo(field);\r\n            },\r\n            submitHandler: function () {\r\n                return false;\r\n            },\r\n            invalidHandler: function (event: any, validator: JQueryValidation.Validator) {\r\n                Q.notifyError(Q.text(\"Validation.InvalidFormMessage\"));\r\n\r\n                $(validator.errorList.map(x => x.element))\r\n                    .closest('.category.collapsed')\r\n                    .children('.category-title')\r\n                    .each((i, x) => {\r\n                        $(x).click();\r\n                        return true;\r\n                    });\r\n\r\n                if (validator.errorList.length)\r\n                {\r\n                    var el = validator.errorList[0].element;\r\n                    if (el) {\r\n                        var bsPane = $(el).closest('.tab-pane');\r\n                        if (!bsPane.hasClass(\"active\") &&\r\n                            bsPane.parent().hasClass('tab-content')) {\r\n                            var bsPaneId = bsPane.attr('id');\r\n                            if (bsPaneId) {\r\n                                $('a[href=\"#' + bsPaneId + '\"]').click();\r\n                            }\r\n                        }\r\n\r\n                        if ($.fn.tooltip) {\r\n                            var $el = $(el);\r\n                            if ($el.hasClass('select2-offscreen') &&\r\n                                el.id) {\r\n                                $el = $('#s2id_' + el.id);\r\n                            }\r\n\r\n                            $.fn.tooltip && ($el as any).tooltip({\r\n                                title: validator.errorList[0].message,\r\n                                trigger: 'manual'\r\n                            }).tooltip('show');\r\n\r\n                            window.setTimeout(function () {\r\n                                $el.tooltip('destroy');\r\n                            }, 1500);\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            success: function (label: JQuery) {\r\n                label.addClass('checked');\r\n            }\r\n        }), options);\r\n    };\r\n\r\n    if ($.validator)\r\n        jQueryValidationInitialization()\r\n    else $(function () {\r\n        $.validator && jQueryValidationInitialization();\r\n    });\r\n}\r\n\r\nnamespace Serenity {\r\n    export namespace ValidationHelper {\r\n        export function asyncSubmit(form: JQuery, validateBeforeSave: () => boolean, submitHandler: () => void): boolean {\r\n            var validator = form.validate();\r\n            var valSettings = validator.settings;\r\n            if ((valSettings as any).abortHandler) {\r\n                return false;\r\n            }\r\n            if (validateBeforeSave != null && validateBeforeSave() === false) {\r\n                return false;\r\n            }\r\n            valSettings['abortHandler'] = Q.validatorAbortHandler;\r\n            valSettings['submitHandler'] = function () {\r\n                if (submitHandler != null) {\r\n                    submitHandler();\r\n                }\r\n                return false;\r\n            };\r\n            form.trigger('submit');\r\n            return true;\r\n        }\r\n\r\n        export function submit(form: JQuery, validateBeforeSave: () => boolean, submitHandler: () => void): boolean {\r\n            var validator = form.validate();\r\n            var valSettings = validator.settings;\r\n            if ((valSettings as any).abortHandler != null) {\r\n                return false;\r\n            }\r\n            if (validateBeforeSave != null && validateBeforeSave() === false) {\r\n                return false;\r\n            }\r\n            if (!validator.form()) {\r\n                return false;\r\n            }\r\n            if (submitHandler != null) {\r\n                submitHandler();\r\n            }\r\n            return true;\r\n        }\r\n\r\n        export function getValidator(element: JQuery): JQueryValidation.Validator {\r\n            var form = element.closest('form');\r\n            if (form.length === 0) {\r\n                return null;\r\n            }\r\n            return form.data('validator');\r\n        }\r\n    }\r\n\r\n    export namespace VX {\r\n        export var addValidationRule = Q.addValidationRule;\r\n        export var removeValidationRule = Q.removeValidationRule;\r\n\r\n        export function validateElement(validator: JQueryValidation.Validator, widget: Serenity.Widget<any>): boolean {\r\n            return validator.element(widget.element[0] as any);\r\n        }\r\n    }\r\n}","namespace Serenity {\r\n    export class TemplatedPanel<TOptions> extends TemplatedWidget<TOptions> {\r\n        constructor(container: JQuery, options?: TOptions) {\r\n            super(container, options);\r\n\r\n            this.initValidator();\r\n            this.initTabs();\r\n            this.initToolbar();\r\n        }\r\n\r\n        destroy() {\r\n            if (this.tabs) {\r\n                this.tabs.tabs('destroy');\r\n                this.tabs = null;\r\n            }\r\n\r\n\t\t\tif (this.toolbar) {\r\n                this.toolbar.destroy();\r\n                this.toolbar = null;\r\n            }\r\n\r\n\t\t\tif (this.validator) {\r\n                this.byId('Form').remove();\r\n                this.validator = null;\r\n            }\r\n\r\n            super.destroy();\r\n        }\r\n\r\n        protected tabs: JQuery;\r\n        protected toolbar: Serenity.Toolbar;\r\n        protected validator: JQueryValidation.Validator;\r\n        protected isPanel: boolean;\r\n        protected responsive: boolean;\r\n\r\n        protected arrange(): void {\r\n            this.element.find('.require-layout').filter(':visible').each(function (i, e) {\r\n                $(e).triggerHandler('layout');\r\n            });\r\n        }\r\n\r\n        protected getToolbarButtons(): ToolButton[] {\r\n            return [];\r\n        }\r\n\r\n        protected getValidatorOptions(): JQueryValidation.ValidationOptions {\r\n            return {};\r\n        }\r\n\r\n        protected initTabs(): void {\r\n            var tabsDiv = this.byId('Tabs');\r\n            if (tabsDiv.length === 0) {\r\n                return;\r\n            }\r\n            this.tabs = tabsDiv.tabs({});\r\n        }\r\n\r\n        protected initToolbar(): void {\r\n            var toolbarDiv = this.byId('Toolbar');\r\n            if (toolbarDiv.length === 0) {\r\n                return;\r\n            }\r\n            var opt = { buttons: this.getToolbarButtons() };\r\n            this.toolbar = new Toolbar(toolbarDiv, opt);\r\n        }\r\n\r\n        protected initValidator(): void {\r\n            var form = this.byId('Form');\r\n            if (form.length > 0) {\r\n                var valOptions = this.getValidatorOptions();\r\n                this.validator = form.validate(Q.validateOptions(valOptions));\r\n            }\r\n        }\r\n\r\n        protected resetValidation(): void {\r\n            if (this.validator) {\r\n                (this.validator as any).resetAll();\r\n            }\r\n        }\r\n\r\n        protected validateForm(): boolean {\r\n            return this.validator == null || !!this.validator.form();\r\n        }\r\n    }\r\n}","namespace Serenity {\r\n    export namespace TabsExtensions {\r\n        export function setDisabled(tabs: JQuery, tabKey: string, isDisabled: boolean) {\r\n            if (!tabs)\r\n                return;\r\n\r\n            var ibk = indexByKey(tabs);\r\n            if (!ibk)\r\n                return;\r\n\r\n            var index = ibk[tabKey];\r\n            if (index == null) {\r\n                return;\r\n            }\r\n\r\n            if (isDisabled && index === tabs.tabs('option', 'active')) {\r\n                tabs.tabs('option', 'active', 0);\r\n            }\r\n\r\n            tabs.tabs(isDisabled ? 'disable' : 'enable', index);\r\n        }\r\n\r\n        export function toggle(tabs: JQuery, tabKey: string, visible: boolean) {\r\n            if (!tabs)\r\n                return;\r\n\r\n            var ibk = indexByKey(tabs);\r\n            if (!ibk)\r\n                return;\r\n\r\n            var index = ibk[tabKey];\r\n            if (index == null) {\r\n                return;\r\n            }\r\n\r\n            if (!visible && index === tabs.tabs('option', 'active')) {\r\n                tabs.tabs('option', 'active', 0);\r\n            }\r\n\r\n            tabs.children('ul').children('li').eq(index).toggle(visible);\r\n        }\r\n\r\n        export function activeTabKey(tabs: JQuery) {\r\n            var href = tabs.children('ul')\r\n                .children('li')\r\n                .eq(tabs.tabs('option', 'active'))\r\n                .children('a')\r\n                .attr('href')\r\n                .toString();\r\n\r\n            var prefix = '_Tab';\r\n            var lastIndex = href.lastIndexOf(prefix);\r\n            if (lastIndex >= 0) {\r\n                href = href.substr(lastIndex + prefix.length);\r\n            }\r\n            return href;\r\n        }\r\n\r\n        export function indexByKey(tabs: JQuery): any {\r\n            var indexByKey = tabs.data('indexByKey');\r\n            if (!indexByKey) {\r\n                indexByKey = {};\r\n                tabs.children('ul').children('li').children('a').each(function (index, el) {\r\n                    var href = el.getAttribute('href').toString();\r\n                    var prefix = '_Tab';\r\n                    var lastIndex = href.lastIndexOf(prefix);\r\n                    if (lastIndex >= 0) {\r\n                        href = href.substr(lastIndex + prefix.length);\r\n                    }\r\n                    indexByKey[href] = index;\r\n                });\r\n                tabs.data('indexByKey', indexByKey);\r\n            }\r\n\r\n            return indexByKey;\r\n        }\r\n        \r\n        export function selectTab(tabs: JQuery, tabKey: string) {\r\n            var ibk = indexByKey(tabs);\r\n            if (!ibk)\r\n                return;\r\n            var index = ibk[tabKey];\r\n            if (index == null) {\r\n                return;\r\n            }\r\n            if (index !== tabs.tabs('option', 'active')) {\r\n                tabs.tabs('option', 'active', index);\r\n            }\r\n        }\r\n    }\r\n}\r\n","namespace Serenity {\r\n    export namespace ReflectionOptionsSetter {\r\n        export function set(target: any, options: any): void {\r\n            if (options == null) {\r\n                return;\r\n            }\r\n\r\n            var type = Q.getInstanceType(target);\r\n\r\n            if (type === Object) {\r\n                return;\r\n            }\r\n\r\n            var propByName = type.__propByName;\r\n            var fieldByName = type.__fieldByName;\r\n            if (propByName == null) {\r\n                var props = Q.getMembers(type, Q.MemberType.property);\r\n                var propList = props.filter(function (x: any) {\r\n                    return !!x.setter && ((x.attr || []).filter(function (a: any) {\r\n                        return Q.isInstanceOfType(a, Serenity.OptionAttribute);\r\n                    }).length > 0 || (x.attr || []).filter(function (a: any) {\r\n                        return Q.isInstanceOfType(a, System.ComponentModel.DisplayNameAttribute);\r\n                    }).length > 0);\r\n                });\r\n\r\n                propByName = {};\r\n                for (var k of propList) {\r\n                    propByName[ReflectionUtils.makeCamelCase(k.name)] = k;\r\n                }\r\n\r\n                type.__propByName = propByName;\r\n            }\r\n\r\n            if (fieldByName == null) {\r\n                var fields = Q.getMembers(type, Q.MemberType.field);\r\n                var fieldList = fields.filter(function (x1: any) {\r\n                    return (x1.attr || []).filter(function (a: any) {\r\n                        return Q.isInstanceOfType(a, Serenity.OptionAttribute);\r\n                    }).length > 0 || (x1.attr || []).filter(function (a: any) {\r\n                        return Q.isInstanceOfType(a, System.ComponentModel.DisplayNameAttribute);\r\n                    }).length > 0;\r\n                });\r\n\r\n                fieldByName = {};\r\n                for (var $t2 = 0; $t2 < fieldList.length; $t2++) {\r\n                    var k1 = fieldList[$t2];\r\n                    fieldByName[ReflectionUtils.makeCamelCase(k1.name)] = k1;\r\n                }\r\n                type.__fieldByName = fieldByName;\r\n            }\r\n\r\n            var keys = Object.keys(options);\r\n            for (var k2 of keys) {\r\n                var v = options[k2];\r\n                var cc = ReflectionUtils.makeCamelCase(k2);\r\n                var p = propByName[cc] || propByName[k2];\r\n                if (p != null) {\r\n                    var func = (target[p.setter] as Function);\r\n                    func && func.call(target, v);\r\n                }\r\n                else {\r\n                    var f = fieldByName[cc] || fieldByName[k2];\r\n                    f && (target[f.name] = v);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","namespace Serenity {\r\n\r\n    @Decorators.registerClass('PropertyGrid')\r\n    export class PropertyGrid extends Widget<PropertyGridOptions> {\r\n\r\n        private editors: Widget<any>[];\r\n        private items: PropertyItem[];\r\n\r\n        constructor(div: JQuery, opt: PropertyGridOptions) {\r\n            super(div, opt);\r\n\r\n            if (opt.mode == null)\r\n                opt.mode = 1;\r\n\r\n            div.addClass('s-PropertyGrid');\r\n            this.editors = [];\r\n            var items = this.options.items || [];\r\n            this.items = [];\r\n\r\n            var useTabs = Q.any(items, function (x) {\r\n                return !Q.isEmptyOrNull(x.tab);\r\n            });\r\n\r\n            if (useTabs) {\r\n                var itemsWithoutTab = items.filter(f => Q.isEmptyOrNull(f.tab));\r\n                if (itemsWithoutTab.length > 0) {\r\n                    this.createItems(this.element, itemsWithoutTab);\r\n\r\n                    $(\"<div class='pad'></div>\").appendTo(this.element);\r\n                }\r\n\r\n                var itemsWithTab = items.filter(f => !Q.isEmptyOrNull(f.tab));\r\n\r\n                var ul = $(\"<ul class='nav nav-tabs property-tabs' role='tablist'></ul>\")\r\n                    .appendTo(this.element);\r\n\r\n                var tc = $(\"<div class='tab-content property-panes'></div>\")\r\n                    .appendTo(this.element);\r\n\r\n                var tabIndex = 0;\r\n                var i = 0;\r\n                while (i < itemsWithTab.length) {\r\n                    var tab = { $: Q.trimToEmpty(itemsWithTab[i].tab) };\r\n                    var tabItems = [];\r\n\r\n                    var j = i;\r\n                    do {\r\n                        tabItems.push(itemsWithTab[j]);\r\n                    } while (++j < itemsWithTab.length &&\r\n                        Q.trimToEmpty(itemsWithTab[j].tab) === tab.$);\r\n                    i = j;\r\n\r\n                    var li = $(\"<li><a data-toggle='tab' role='tab'></a></li>\")\r\n                        .appendTo(ul);\r\n\r\n                    if (tabIndex === 0) {\r\n                        li.addClass('active');\r\n                    }\r\n\r\n                    var tabID = this.uniqueName + '_Tab' + tabIndex;\r\n\r\n                    li.children('a').attr('href', '#' + tabID)\r\n                        .text(this.determineText(tab.$, function (prefix: string) {\r\n                            return prefix + 'Tabs.' + this.tab.$;\r\n                        }.bind({\r\n                            tab: tab\r\n                        })));\r\n\r\n                    var pane = $(\"<div class='tab-pane fade' role='tabpanel'>\")\r\n                        .appendTo(tc);\r\n\r\n                    if (tabIndex === 0) {\r\n                        pane.addClass('in active');\r\n                    }\r\n\r\n                    pane.attr('id', tabID);\r\n                    this.createItems(pane, tabItems);\r\n                    tabIndex++;\r\n                }\r\n            }\r\n            else {\r\n                this.createItems(this.element, items);\r\n            }\r\n\r\n            this.updateInterface();\r\n        }\r\n\r\n        destroy() {\r\n            if (this.editors != null) {\r\n                for (var i = 0; i < this.editors.length; i++) {\r\n                    this.editors[i].destroy();\r\n                }\r\n                this.editors = null;\r\n            }\r\n            this.element.find('a.category-link').unbind('click',\r\n                this.categoryLinkClick).remove();\r\n\r\n            Serenity.Widget.prototype.destroy.call(this);\r\n        }\r\n\r\n        private createItems(container: JQuery, items: PropertyItem[]) {\r\n            var categoryIndexes = {};\r\n            var categoriesDiv = container;\r\n\r\n            var useCategories = this.options.useCategories !== false && Q.any(items, function (x) {\r\n                return !Q.isEmptyOrNull(x.category);\r\n            });\r\n\r\n            if (useCategories) {\r\n                var linkContainer = $('<div/>').addClass('category-links');\r\n                categoryIndexes = this.createCategoryLinks(linkContainer, items);\r\n                if (Object.keys(categoryIndexes).length > 1) {\r\n                    linkContainer.appendTo(container);\r\n                }\r\n                else {\r\n                    linkContainer.find('a.category-link').unbind('click',\r\n                        this.categoryLinkClick).remove();\r\n                }\r\n            }\r\n\r\n            categoriesDiv = $('<div/>').addClass('categories').appendTo(container);\r\n            var fieldContainer;\r\n            if (useCategories) {\r\n                fieldContainer = categoriesDiv;\r\n            }\r\n            else {\r\n                fieldContainer = $('<div/>').addClass('category').appendTo(categoriesDiv);\r\n            }\r\n            var priorCategory = null;\r\n            for (var i = 0; i < items.length; i++) {\r\n                var item = items[i];\r\n                var category = item.category;\r\n                if (category == null) {\r\n                    category = Q.coalesce(this.options.defaultCategory, '');\r\n                }\r\n\r\n                if (useCategories && priorCategory !== category) {\r\n                    var categoryDiv = this.createCategoryDiv(categoriesDiv,\r\n                        categoryIndexes, category,\r\n                        ((item.collapsible !== true) ? null :\r\n                            Q.coalesce(item.collapsed, false)));\r\n\r\n                    if (priorCategory == null) {\r\n                        categoryDiv.addClass('first-category');\r\n                    }\r\n                    priorCategory = category;\r\n                    fieldContainer = categoryDiv;\r\n                }\r\n                var editor = this.createField(fieldContainer, item);\r\n                this.items.push(item);\r\n                this.editors.push(editor);\r\n            }\r\n        }\r\n\r\n        private createCategoryDiv(categoriesDiv: JQuery,\r\n            categoryIndexes: Q.Dictionary<number>, category: string, collapsed: boolean) {\r\n\r\n            var categoryDiv = $('<div/>').addClass('category')\r\n                .appendTo(categoriesDiv);\r\n\r\n            var title = $('<div/>').addClass('category-title')\r\n                .append($('<a/>').addClass('category-anchor')\r\n                .text(this.determineText(category, function (prefix) {\r\n                    return prefix + 'Categories.' + category;\r\n                }))\r\n                .attr('name', this.options.idPrefix + \r\n                    'Category' + categoryIndexes[category].toString()))\r\n                .appendTo(categoryDiv);\r\n\r\n            if (collapsed != null) {\r\n                categoryDiv.addClass(((collapsed === true) ?\r\n                    'collapsible collapsed' : 'collapsible'));\r\n\r\n                var img = $('<i/>').addClass(((collapsed === true) ?\r\n                    'fa fa-plus' : 'fa fa-minus')).appendTo(title);\r\n\r\n                title.click(function (e) {\r\n                    categoryDiv.toggleClass('collapsed');\r\n                    img.toggleClass('fa-plus').toggleClass('fa-minus');\r\n                });\r\n            }\r\n\r\n\t\t\treturn categoryDiv;\r\n        }\r\n\r\n        private categoryLinkClick = (e: JQueryEventObject) => {\r\n            e.preventDefault();\r\n\r\n            var title = $('a[name=' + e.target.getAttribute('href')\r\n                .toString().substr(1) + ']');\r\n\r\n            if (title.closest('.category').hasClass('collapsed'))\r\n                title.closest('.category').children('.category-title').click();\r\n\r\n            var animate = function () {\r\n                title.fadeTo(100, 0.5, function () {\r\n                    title.fadeTo(100, 1, function () {\r\n                    });\r\n                });\r\n            };\r\n\r\n            var intoView = title.closest('.category');\r\n            if (intoView.closest(':scrollable(both)').length === 0)\r\n                animate();\r\n            else {\r\n                (intoView as any).scrollintoview({\r\n                    duration: 'fast',\r\n                    direction: 'y',\r\n                    complete: animate\r\n                });\r\n            }\r\n        }\r\n\r\n        private determineText(text: string, getKey: (s: string) => string) {\r\n            if (text != null && !Q.startsWith(text, '`')) {\r\n                var local = Q.tryGetText(text);\r\n                if (local != null) {\r\n                    return local;\r\n                }\r\n            }\r\n\r\n            if (text != null && Q.startsWith(text, '`')) {\r\n                text = text.substr(1);\r\n            }\r\n\r\n\t\t\tif (!Q.isEmptyOrNull(this.options.localTextPrefix)) {\r\n                var local1 = Q.tryGetText(getKey(this.options.localTextPrefix));\r\n                if (local1 != null) {\r\n                    return local1;\r\n                }\r\n            }\r\n\r\n\t\t\treturn text;\r\n        }\r\n\r\n        private createField(container: JQuery, item: PropertyItem) {\r\n            var fieldDiv = $('<div/>').addClass('field')\r\n                .addClass(item.name).data('PropertyItem', item).appendTo(container);\r\n\r\n            if (!Q.isEmptyOrNull(item.cssClass)) {\r\n                fieldDiv.addClass(item.cssClass);\r\n            }\r\n\r\n            if (!Q.isEmptyOrNull(item.formCssClass)) {\r\n                fieldDiv.addClass(item.formCssClass);\r\n                if (item.formCssClass.indexOf('line-break-') >= 0) {\r\n                    var splitted = item.formCssClass.split(String.fromCharCode(32));\r\n                    if (splitted.indexOf('line-break-xs') >= 0) {\r\n                        $(\"<div class='line-break' style='width: 100%' />\")\r\n                            .insertBefore(fieldDiv);\r\n                    }\r\n                    else if (splitted.indexOf('line-break-sm') >= 0) {\r\n                        $(\"<div class='line-break hidden-xs' style='width: 100%' />\")\r\n                            .insertBefore(fieldDiv);\r\n                    }\r\n                    else if (splitted.indexOf('line-break-md') >= 0) {\r\n                        $(\"<div class='line-break hidden-sm' style='width: 100%' />\")\r\n                            .insertBefore(fieldDiv);\r\n                    }\r\n                    else if (splitted.indexOf('line-break-lg') >= 0) {\r\n                        $(\"<div class='line-break hidden-md' style='width: 100%' />\")\r\n                            .insertBefore(fieldDiv);\r\n                    }\r\n                }\r\n            }\r\n            var editorId = this.options.idPrefix + item.name;\r\n            var title = this.determineText(item.title, function (prefix) {\r\n                return prefix + item.name;\r\n            });\r\n\r\n            var hint = this.determineText(item.hint, function (prefix1) {\r\n                return prefix1 + item.name + '_Hint';\r\n            });\r\n\r\n            var placeHolder = this.determineText(item.placeholder, function (prefix2) {\r\n                return prefix2 + item.name + '_Placeholder';\r\n            });\r\n\r\n            if (hint == null) {\r\n                hint = Q.coalesce(title, '');\r\n            }\r\n\r\n            var label = $('<label/>')\r\n                .addClass('caption').attr('for', editorId)\r\n                .attr('title', hint).html(Q.coalesce(title, ''))\r\n                .appendTo(fieldDiv);\r\n\r\n            if (!Q.isEmptyOrNull(item.labelWidth)) {\r\n                if (item.labelWidth === '0') {\r\n                    label.hide();\r\n                }\r\n                else {\r\n                    label.css('width', item.labelWidth);\r\n                }\r\n            }\r\n\r\n            if (item.required === true) {\r\n                $('<sup>*</sup>').attr('title',\r\n                    Q.text('Controls.PropertyGrid.RequiredHint'))\r\n                    .prependTo(label);\r\n            }\r\n\r\n            var editorType = Serenity.EditorTypeRegistry\r\n                .get(Q.coalesce(item.editorType, 'String'));\r\n            var elementAttr = Q.getAttributes(editorType,\r\n                Serenity.ElementAttribute, true);\r\n            var elementHtml = ((elementAttr.length > 0) ?\r\n                elementAttr[0].value : '<input/>');\r\n\r\n            var element = Widget.elementFor(editorType as any)\r\n                .addClass('editor')\r\n                .attr('id', editorId).appendTo(fieldDiv);\r\n\r\n            if (element.is(':input')) {\r\n                element.attr('name', Q.coalesce(item.name, ''));\r\n            }\r\n\r\n            if (!Q.isEmptyOrNull(placeHolder)) {\r\n                element.attr('placeholder', placeHolder);\r\n            }\r\n            var editorParams = item.editorParams;\r\n            var optionsType = null;\r\n            var optionsAttr = Q.getAttributes(editorType,\r\n                Serenity.OptionsTypeAttribute, true);\r\n\r\n            if (optionsAttr != null && optionsAttr.length > 0) {\r\n                optionsType = optionsAttr[0].optionsType;\r\n            }\r\n            var editor;\r\n            if (optionsType != null) {\r\n                editorParams = Q.extend(new optionsType(), item.editorParams);\r\n                editor = new (editorType as any)(element, editorParams);\r\n            }\r\n            else {\r\n                editorParams = Q.extend(new Object(), item.editorParams);\r\n                editor = new (editorType as any)(element, editorParams);\r\n            }\r\n\r\n            editor.initialize();\r\n\r\n            if (Q.getTypeName(editor) == \"BooleanEditor\" &&\r\n                (item.editorParams == null || !!!item.editorParams['labelFor'])) {\r\n                label.removeAttr('for');\r\n            }\r\n\r\n            if (Q.getTypeName(editor) == \"RadioButtonEditor\" &&\r\n                (item.editorParams == null || !!!item.editorParams['labelFor'])) {\r\n                label.removeAttr('for');\r\n            }\r\n\r\n            if (item.maxLength != null) {\r\n                PropertyGrid.setMaxLength(editor, item.maxLength);\r\n            }\r\n\r\n            if (item.editorParams != null) {\r\n                ReflectionOptionsSetter.set(editor, item.editorParams);\r\n            }\r\n\r\n            $('<div/>').addClass('vx').appendTo(fieldDiv);\r\n            $('<div/>').addClass('clear').appendTo(fieldDiv);\r\n\r\n            return editor;\r\n        }\r\n\r\n        private getCategoryOrder(items: PropertyItem[]) {\r\n            var order = 0;\r\n            var result = {};\r\n            var categoryOrder = Q.trimToNull(this.options.categoryOrder);\r\n            if (categoryOrder != null) {\r\n                var split = categoryOrder.split(';');\r\n                for (var s of split) {\r\n                    var x = Q.trimToNull(s);\r\n                    if (x == null) {\r\n                        continue;\r\n                    }\r\n                    if (result[x] != null) {\r\n                        continue;\r\n                    }\r\n                    result[x] = order++;\r\n                }\r\n            }\r\n\r\n            for (var x1 of items) {\r\n                var category = x1.category;\r\n                if (category == null) {\r\n                    category = Q.coalesce(this.options.defaultCategory, '');\r\n                }\r\n                if (result[category] == null) {\r\n                    result[category] = order++;\r\n                }\r\n            }\r\n\r\n            return result;\r\n        }\r\n\r\n        private createCategoryLinks(container: JQuery, items: PropertyItem[]) {\r\n\t\t\tvar idx = 0;\r\n\t\t\tvar itemIndex = {};\r\n\t\t\tvar itemCategory = {};\r\n            for (var x of items) {\r\n\t\t\t\tvar name1 = x.name;\r\n\t\t\t\tvar cat1 = x.category;\r\n\t\t\t\tif (cat1 == null) {\r\n\t\t\t\t\tcat1 = Q.coalesce(this.options.defaultCategory, '');\r\n\t\t\t\t}\r\n\t\t\t\titemCategory[name1] = cat1;\r\n\t\t\t\titemIndex[x.name] = idx++;\r\n            }\r\n\r\n\t\t\tvar self = this;\r\n\t\t\tvar categoryOrder = this.getCategoryOrder(items);\r\n\r\n            items.sort(function (x1, y) {\r\n\t\t\t\tvar c = 0;\r\n\t\t\t\tvar xcategory = itemCategory[x1.name];\r\n\t\t\t\tvar ycategory = itemCategory[y.name];\r\n\t\t\t\tif (xcategory != ycategory) {\r\n\t\t\t\t\tvar c1 = categoryOrder[xcategory];\r\n\t\t\t\t\tvar c2 = categoryOrder[ycategory];\r\n\t\t\t\t\tif (c1 != null && c2 != null) {\r\n\t\t\t\t\t\tc = c1 - c2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (c1 != null) {\r\n\t\t\t\t\t\tc = -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (c2 != null) {\r\n\t\t\t\t\t\tc = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (c === 0) {\r\n\t\t\t\t\tc = Q.Culture.stringCompare(xcategory, ycategory);\r\n\t\t\t\t}\r\n\t\t\t\tif (c === 0) {\r\n\t\t\t\t\tc = itemIndex[x1.name] < itemIndex[y.name] ? -1 : (itemIndex[x1.name] > itemIndex[y.name] ? 1 : 0)\r\n\t\t\t\t}\r\n\t\t\t\treturn c;\r\n            });\r\n\r\n\t\t\tvar categoryIndexes = {};\r\n\t\t\tfor (var i = 0; i < items.length; i++) {\r\n\t\t\t\tvar item = items[i];\r\n\t\t\t\tvar category = { $: itemCategory[item.name] };\r\n                if (categoryIndexes[category.$] == null) {\r\n                    var index = Object.keys(categoryIndexes).length + 1;\r\n\t\t\t\t\tcategoryIndexes[category.$] = index;\r\n\t\t\t\t\tif (index > 1) {\r\n\t\t\t\t\t\t$('<span/>').addClass('separator').text('|').prependTo(container);\r\n\t\t\t\t\t}\r\n                    $('<a/>').addClass('category-link').text(\r\n                        this.determineText(category.$,\r\n                            function (prefix: string) {\r\n                                return prefix + 'Categories.' + this.category.$;\r\n                            }.bind({ category: category })))\r\n                        .attr('tabindex', '-1')\r\n                        .attr('href', '#' + this.options.idPrefix +\r\n                            'Category' + index.toString())\r\n                        .click(this.categoryLinkClick)\r\n                        .prependTo(container);\r\n\t\t\t\t}\r\n            }\r\n\r\n\t\t\t$('<div/>').addClass('clear').appendTo(container);\r\n\t\t\treturn categoryIndexes;\r\n        }\r\n\r\n        get_editors(): Widget<any>[] {\r\n            return this.editors;\r\n        }\r\n\r\n        get_items(): PropertyItem[] {\r\n            return this.items;\r\n        }\r\n\r\n        get_idPrefix(): string {\r\n            return this.options.idPrefix;\r\n        }\r\n\r\n        get_mode(): PropertyGridMode {\r\n            return this.options.mode;\r\n        }\r\n\r\n        set_mode(value: PropertyGridMode) {\r\n            if(this.options.mode !== value) {\r\n                this.options.mode = value;\r\n                this.updateInterface();\r\n            }\r\n        }\r\n\r\n        // Obsolete\r\n        static loadEditorValue(editor: Serenity.Widget<any>,\r\n            item: PropertyItem, source: any): void {\r\n        }\r\n\r\n        // Obsolete\r\n        static saveEditorValue(editor: Serenity.Widget<any>,\r\n            item: PropertyItem, target: any): void {\r\n\r\n            EditorUtils.saveValue(editor, item, target);\r\n        }\r\n\r\n        // Obsolete\r\n        private static setReadOnly(widget: Serenity.Widget<any>, isReadOnly: boolean): void {\r\n            EditorUtils.setReadOnly(widget, isReadOnly);\r\n        }\r\n\r\n        // Obsolete\r\n        private static setReadonly(elements: JQuery, isReadOnly: boolean): JQuery {\r\n            return EditorUtils.setReadonly(elements, isReadOnly);\r\n        }\r\n\r\n        // Obsolete\r\n        private static setRequired(widget: Serenity.Widget<any>, isRequired: boolean): void {\r\n            EditorUtils.setRequired(widget, isRequired);\r\n        }\r\n\r\n        private static setMaxLength(widget: Widget<any>, maxLength: number) {\r\n            if (widget.element.is(':input')) {\r\n                if (maxLength > 0) {\r\n                    widget.element.attr('maxlength', maxLength);\r\n                }\r\n                else {\r\n                    widget.element.removeAttr('maxlength');\r\n                }\r\n            }\r\n        }\r\n\r\n        load(source: any): void {\r\n            for (var i = 0; i < this.editors.length; i++) {\r\n                var item = this.items[i];\r\n                var editor = this.editors[i];\r\n                if (!!(this.get_mode() === 1 && item.defaultValue != null) &&\r\n                    typeof (source[item.name]) === 'undefined') {\r\n                    source[item.name] = item.defaultValue;\r\n                }\r\n\r\n                Serenity.EditorUtils.loadValue(editor, item, source);\r\n            }\r\n        }\r\n\r\n        save(target?: any): any {\r\n            if (target == null)\r\n                target = Object.create(null);\r\n            for (var i = 0; i < this.editors.length; i++) {\r\n                var item = this.items[i];\r\n                if (item.oneWay !== true && this.canModifyItem(item)) {\r\n                    var editor = this.editors[i];\r\n                    Serenity.EditorUtils.saveValue(editor, item, target);\r\n                }\r\n            }\r\n            return target;\r\n        }\r\n\r\n        public get value(): any {\r\n            return this.save();\r\n        }\r\n\r\n        public set value(val: any) {\r\n            if (val == null)\r\n                val = Object.create(null);\r\n            this.load(val);\r\n        }\r\n\r\n        private canModifyItem(item: PropertyItem) {\r\n            if (this.get_mode() === PropertyGridMode.insert) {\r\n                if (item.insertable === false) {\r\n                    return false;\r\n                }\r\n\r\n                if (item.insertPermission == null) {\r\n                    return true;\r\n                }\r\n\r\n                return Q.Authorization.hasPermission(item.insertPermission);\r\n            }\r\n            else if (this.get_mode() === PropertyGridMode.update) {\r\n                if (item.updatable === false) {\r\n                    return false;\r\n                }\r\n\r\n                if (item.updatePermission == null) {\r\n                    return true;\r\n                }\r\n\r\n                return Q.Authorization.hasPermission(item.updatePermission);\r\n            }\r\n\t\t\treturn true;\r\n        }\r\n\r\n        updateInterface() {\r\n            for (var i = 0; i < this.editors.length; i++) {\r\n                var item = this.items[i];\r\n                var editor = this.editors[i];\r\n                var readOnly = item.readOnly === true || !this.canModifyItem(item);\r\n                Serenity.EditorUtils.setReadOnly(editor, readOnly);\r\n                Serenity.EditorUtils.setRequired(editor, !readOnly &&\r\n                    !!item.required && item.editorType !== 'Boolean');\r\n                if (item.visible === false || item.readPermission != null ||\r\n                    item.insertPermission != null || item.updatePermission != null ||\r\n                    item.hideOnInsert === true || item.hideOnUpdate === true) {\r\n                    var hidden = (item.readPermission != null &&\r\n                        !Q.Authorization.hasPermission(item.readPermission)) ||\r\n                        item.visible === false ||\r\n                        (this.get_mode() === PropertyGridMode.insert && item.hideOnInsert === true) ||\r\n                        (this.get_mode() === 2 && item.hideOnUpdate === true);\r\n\r\n                    editor.getGridField().toggle(!hidden);\r\n                }\r\n            }\r\n        }\r\n\r\n        enumerateItems(callback: (p1: PropertyItem, p2: Serenity.Widget<any>) => void): void {\r\n            for (var i = 0; i < this.editors.length; i++) {\r\n                var item = this.items[i];\r\n                var editor = this.editors[i];\r\n                callback(item, editor);\r\n            }\r\n        }\r\n    }\r\n\r\n    export declare const enum PropertyGridMode {\r\n        insert = 1,\r\n        update = 2\r\n    }\r\n\r\n    export interface PropertyGridOptions {\r\n        idPrefix?: string;\r\n        items?: PropertyItem[];\r\n        useCategories?: boolean;\r\n        categoryOrder?: string;\r\n        defaultCategory?: string;\r\n        localTextPrefix?: string;\r\n        mode?: PropertyGridMode;\r\n    }\r\n}","namespace Serenity {\r\n\r\n    @Decorators.registerClass('Serenity.PropertyPanel')\r\n    export class PropertyPanel<TItem, TOptions> extends TemplatedPanel<TOptions> {\r\n\r\n        private _entity: TItem;\r\n        private _entityId: any;\r\n\r\n        constructor(container: JQuery, options?: TOptions) {\r\n            super(container, options);\r\n\r\n            this.initPropertyGrid();\r\n            this.loadInitialEntity();\r\n        }\r\n\r\n        destroy() {\r\n            if (this.propertyGrid) {\r\n                this.propertyGrid.destroy();\r\n                this.propertyGrid = null;\r\n            }\r\n            if (this.validator) {\r\n                this.byId('Form').remove();\r\n                this.validator = null;\r\n            }\r\n            super.destroy();\r\n        }\r\n\r\n        protected initPropertyGrid() {\r\n            var pgDiv = this.byId('PropertyGrid');\r\n            if (pgDiv.length <= 0) {\r\n                return;\r\n            }\r\n            var pgOptions = this.getPropertyGridOptions();\r\n            this.propertyGrid = (new Serenity.PropertyGrid(pgDiv, pgOptions)).init(null);\r\n            if (this.element.closest('.ui-Panel').hasClass('s-Flexify')) {\r\n                this.propertyGrid.element.children('.categories').flexHeightOnly(1);\r\n            }\r\n        }\r\n\r\n        protected loadInitialEntity(): void {\r\n            if (this.propertyGrid) {\r\n                this.propertyGrid.load(new Object());\r\n            }\r\n        }\r\n\r\n        protected getFormKey(): string {\r\n            var attributes = Q.getAttributes(\r\n                Q.getInstanceType(this), Serenity.FormKeyAttribute, true);\r\n\r\n            if (attributes.length >= 1) {\r\n                return attributes[0].value;\r\n            }\r\n            var name = Q.getTypeFullName(Q.getInstanceType(this));\r\n            var px = name.indexOf('.');\r\n            if (px >= 0) {\r\n                name = name.substring(px + 1);\r\n            }\r\n            if (Q.endsWith(name, 'Panel')) {\r\n                name = name.substr(0, name.length - 6);\r\n            }\r\n            else if (Q.endsWith(name, 'Panel')) {\r\n                name = name.substr(0, name.length - 5);\r\n            }\r\n            return name;\r\n        }\r\n\r\n        protected getPropertyGridOptions(): PropertyGridOptions {\r\n            return {\r\n                idPrefix: this.idPrefix,\r\n                items: this.getPropertyItems(),\r\n                mode: 1,\r\n                useCategories: false,\r\n                localTextPrefix: 'Forms.' + this.getFormKey() + '.'\r\n            };\r\n        }\r\n\r\n        protected getPropertyItems(): PropertyItem[] {\r\n            var formKey = this.getFormKey();\r\n            return Q.getForm(formKey);\r\n        }\r\n\r\n        protected getSaveEntity(): TItem {\r\n            var entity = new Object();\r\n            if (this.propertyGrid) {\r\n                this.propertyGrid.save(entity);\r\n            }\r\n            return entity as TItem;\r\n        }\r\n\r\n        protected get_entity(): TItem {\r\n            return this._entity;\r\n        }\r\n\r\n        protected get_entityId(): any {\r\n            return this._entityId;\r\n        }\r\n        \r\n        protected set_entity(value: TItem): void {\r\n            this._entity = Q.coalesce(value, new Object());\r\n        }\r\n\r\n        protected set_entityId(value: any): void {\r\n            this._entityId = value;\r\n        }\r\n\r\n        protected validateBeforeSave(): boolean {\r\n            return this.validator.form();\r\n        }\r\n\r\n        protected propertyGrid: Serenity.PropertyGrid;\r\n    }\r\n}","namespace Serenity {\r\n    function vueIntegration() {\r\n        // @ts-ignore\r\n        if (typeof Vue === \"undefined\")\r\n            return false; \r\n        // @ts-ignore\r\n        Vue.component('editor', {\r\n            props: {\r\n                type: {\r\n                    type: String,\r\n                    required: true,                    \r\n                },\r\n                id: {\r\n                    type: String,\r\n                    required: false\r\n                },\r\n                name: {\r\n                    type: String,\r\n                    required: false\r\n                },\r\n                placeholder: {\r\n                    type: String,\r\n                    required: false\r\n                },\r\n                value: {\r\n                    required: false\r\n                },\r\n                options: {\r\n                    required: false\r\n                },\r\n                maxLength: {\r\n                    required: false\r\n                }\r\n            },\r\n            render: function (createElement: any) {\r\n                var editorType = Serenity.EditorTypeRegistry.get(this.type);\r\n                var elementAttr = Q.getAttributes(editorType, Serenity.ElementAttribute, true);\r\n                var elementHtml = ((elementAttr.length > 0) ? elementAttr[0].value : '<input/>') as string;\r\n                var domProps: any = {};\r\n                var element = $(elementHtml)[0];\r\n                var attrs = element.attributes;\r\n                for (var i = 0; i < attrs.length; i++) {\r\n                    var attr = attrs.item(i);\r\n                    domProps[attr.name] = attr.value;\r\n                }\r\n\r\n                if (this.id != null)\r\n                    domProps.id = this.id;\r\n\r\n                if (this.name != null)\r\n                    domProps.name = this.name;\r\n\r\n                if (this.placeholder != null)\r\n                    domProps.placeholder = this.placeholder;\r\n\r\n                var editorParams = this.options;\r\n                var optionsType: any = null;\r\n\r\n                var self = this\r\n                var el = createElement(element.tagName, {\r\n                    domProps: domProps\r\n                });\r\n\r\n                this.$editorType = editorType;\r\n\r\n                return el;\r\n            },\r\n            watch: {\r\n                value: function (v: any) {\r\n                    Serenity.EditorUtils.setValue(this.$widget, v);\r\n                }\r\n            },\r\n            mounted: function () {\r\n                var self = this;\r\n\r\n                this.$widget = new this.$editorType($(this.$el), this.options);\r\n                this.$widget.initialize();\r\n\r\n                if (this.maxLength) {\r\n                    (Serenity.PropertyGrid as any).$setMaxLength(this.$widget, this.maxLength);\r\n                }\r\n\r\n                if (this.options)\r\n                    Serenity.ReflectionOptionsSetter.set(this.$widget, this.options);\r\n\r\n                if (this.value != null)\r\n                    Serenity.EditorUtils.setValue(this.$widget, this.value);\r\n\r\n                if ($(this.$el).data('select2'))\r\n                    this.$widget.changeSelect2(function () {\r\n                        self.$emit('input', Serenity.EditorUtils.getValue(self.$widget));\r\n                    });\r\n                else\r\n                    this.$widget.change(function () {\r\n                        self.$emit('input', Serenity.EditorUtils.getValue(self.$widget));\r\n                    });\r\n            },\r\n            destroyed: function () {\r\n                if (this.$widget) {\r\n                    this.$widget.destroy();\r\n                    this.$widget = null;\r\n                }\r\n            }\r\n        });\r\n        return true;\r\n    }\r\n\r\n    // @ts-ignore\r\n    !vueIntegration() && typeof $ !== \"undefined\" && $(vueIntegration);\r\n}"]}