{"version":3,"file":"serenity-dialogs.js","sourceRoot":"","sources":["../../CoreLib/Q/Q.Router.ts","../../CoreLib/Q/Q.Layout.ts","../../CoreLib/UI/Dialogs/DialogExtensions.ts","../../CoreLib/UI/Dialogs/TemplatedDialog.ts","../../CoreLib/UI/Dialogs/PropertyDialog.ts","../../CoreLib/UI/Dialogs/EntityDialog.ts"],"names":[],"mappings":"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","sourcesContent":["\r\nnamespace Q.Router {\r\n    let oldURL: string;\r\n    let resolving: number = 0;\r\n    let autoinc: number = 0;\r\n    let listenerTimeout: number;\r\n    let ignoreHash: number = 0;\r\n    let ignoreTime: number = 0;\r\n\r\n    export let enabled: boolean = true;\r\n\r\n    function isEqual(url1: string, url2: string) {\r\n        return url1 == url2 || url1 == url2 + '#' || url2 == url1 + '#';\r\n    }\r\n\r\n    export function navigate(hash: string, tryBack?: boolean, silent?: boolean) {\r\n        if (!enabled || resolving > 0)\r\n            return;\r\n\r\n        hash = hash || '';\r\n        hash = hash.replace(/^#/, '');\r\n        hash = (!hash ? \"\" : '#' + hash);\r\n        var newURL = window.location.href.replace(/#$/, '')\r\n            .replace(/#.*$/, '') + hash;\r\n        if (newURL != window.location.href) {\r\n            if (tryBack && oldURL != null && isEqual(oldURL, newURL)) {\r\n                if (silent)\r\n                    ignoreChange();\r\n\r\n                var prior = window.location.href;\r\n                oldURL = null;\r\n                window.history.back();\r\n                return;\r\n            }\r\n\r\n            if (silent)\r\n                ignoreChange();\r\n\r\n            oldURL = window.location.href;\r\n            window.location.hash = hash;\r\n        }\r\n    }\r\n\r\n    export function replace(hash: string, tryBack?: boolean) {\r\n        navigate(hash, tryBack, true);\r\n    }\r\n\r\n    export function replaceLast(hash: string, tryBack?: boolean) {\r\n        if (!enabled)\r\n            return;\r\n\r\n        var current = window.location.hash || '';\r\n        if (current.charAt(0) == '#')\r\n            current = current.substr(1, current.length - 1);\r\n\r\n        var parts = current.split('/+/');\r\n\r\n        if (parts.length > 1) {\r\n            if (hash && hash.length) {\r\n                parts[parts.length - 1] = hash;\r\n                hash = parts.join(\"/+/\");\r\n            }\r\n            else {\r\n                parts.splice(parts.length - 1, 1);\r\n                hash = parts.join(\"/+/\");\r\n            }\r\n        }\r\n        replace(hash, tryBack);\r\n    }\r\n\r\n    function visibleDialogs() {\r\n        return $('.ui-dialog-content:visible, .ui-dialog.panel-hidden>.ui-dialog-content, .s-Panel').toArray().sort((a, b) => {\r\n            return ($(a).data('qrouterorder') || 0) - ($(b).data('qrouterorder') || 0);\r\n        });\r\n    }\r\n\r\n    function dialogOpen(owner: JQuery, element: JQuery, hash: () => string) {\r\n        var route = [];\r\n        var isDialog = owner.hasClass(\".ui-dialog-content\") || owner.hasClass('.s-Panel');\r\n        var dialog = isDialog ? owner :\r\n            owner.closest('.ui-dialog-content, .s-Panel');\r\n        var value = hash();\r\n\r\n        var idPrefix: string;\r\n        if (dialog.length) {\r\n            var dialogs = visibleDialogs();\r\n            var index = dialogs.indexOf(dialog[0]);\r\n\r\n            for (var i = 0; i <= index; i++) {\r\n                var q = $(dialogs[i]).data(\"qroute\") as string;\r\n                if (q && q.length)\r\n                    route.push(q);\r\n            }\r\n\r\n            if (!isDialog) {\r\n                idPrefix = dialog.attr(\"id\");\r\n                if (idPrefix) {\r\n                    idPrefix += \"_\";\r\n                    var id = owner.attr(\"id\");\r\n                    if (id && Q.startsWith(id, idPrefix))\r\n                        value = id.substr(idPrefix.length) + '@' + value;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            var id = owner.attr(\"id\");\r\n            if (id && (!owner.hasClass(\"route-handler\") ||\r\n                $('.route-handler').first().attr(\"id\") != id))\r\n                value = id + \"@\" + value;\r\n        }\r\n\r\n        route.push(value);\r\n        element.data(\"qroute\", value);\r\n        replace(route.join(\"/+/\"));\r\n\r\n        element.bind(\"dialogclose.qrouter panelclose.qrouter\", e => {\r\n            element.data(\"qroute\", null);\r\n            element.unbind(\".qrouter\");\r\n            var prhash = element.data(\"qprhash\");\r\n            var tryBack = $(e.target).closest('.s-MessageDialog').length > 0 || (e && e.originalEvent &&\r\n                ((e.originalEvent.type == \"keydown\" && (e.originalEvent as any).keyCode == 27) ||\r\n                $(e.originalEvent.target).hasClass(\"ui-dialog-titlebar-close\") ||\r\n                $(e.originalEvent.target).hasClass(\"panel-titlebar-close\")));\r\n            if (prhash != null)\r\n                replace(prhash, tryBack);\r\n            else\r\n                replaceLast('', tryBack);\r\n        });\r\n    }\r\n\r\n    export function dialog(owner: JQuery, element: JQuery, hash: () => string) {\r\n        if (!enabled)\r\n            return;\r\n        \r\n        element.on(\"dialogopen.qrouter panelopen.qrouter\", e => {\r\n            dialogOpen(owner, element, hash);\r\n        });\r\n    }\r\n\r\n    export function resolve(hash?: string) {\r\n        if (!enabled)\r\n            return;\r\n\r\n        resolving++;\r\n        try {\r\n            hash = Q.coalesce(Q.coalesce(hash, window.location.hash), '');\r\n            if (hash.charAt(0) == '#')\r\n                hash = hash.substr(1, hash.length - 1);\r\n\r\n            var dialogs = visibleDialogs();\r\n            var newParts = hash.split(\"/+/\");\r\n            var oldParts = dialogs.map(el => $(el).data('qroute') as string);\r\n\r\n            var same = 0;\r\n            while (same < dialogs.length &&\r\n                same < newParts.length &&\r\n                oldParts[same] == newParts[same]) {\r\n                same++;\r\n            }\r\n\r\n            for (var i = same; i < dialogs.length; i++) {\r\n                var d = $(dialogs[i]);\r\n                if (d.hasClass('ui-dialog-content'))\r\n                    d.dialog('close');\r\n                else if (d.hasClass('s-Panel'))\r\n                    Serenity.TemplatedDialog.closePanel(d);\r\n            }\r\n\r\n            for (var i = same; i < newParts.length; i++) {\r\n                var route = newParts[i];\r\n                var routeParts = route.split('@');\r\n                var handler: JQuery;\r\n                if (routeParts.length == 2) {\r\n                    var dialog = i > 0 ? $(dialogs[i - 1]) : $([]);\r\n                    if (dialog.length) {\r\n                        var idPrefix = dialog.attr(\"id\");\r\n                        if (idPrefix) {\r\n                            handler = $('#' + idPrefix + \"_\" + routeParts[0]);\r\n                            if (handler.length) {\r\n                                route = routeParts[1];\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if (!handler || !handler.length) {\r\n                        handler = $('#' + routeParts[0]);\r\n                        if (handler.length) {\r\n                            route = routeParts[1];\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (!handler || !handler.length) {\r\n                    handler = i > 0 ? $(dialogs[i - 1]) :\r\n                        $('.route-handler').first();\r\n                }\r\n\r\n                handler.triggerHandler(\"handleroute\", {\r\n                    handled: false,\r\n                    route: route,\r\n                    parts: newParts,\r\n                    index: i\r\n                });\r\n            }\r\n        }\r\n        finally {\r\n            resolving--;\r\n        }\r\n    }\r\n\r\n    function hashChange(e: any, o: string) {\r\n        if (ignoreHash > 0) {\r\n            if (new Date().getTime() - ignoreTime > 1000) {\r\n                ignoreHash = 0;\r\n            }\r\n            else {\r\n                ignoreHash--;\r\n                return;\r\n            }\r\n        }\r\n        resolve();\r\n    }\r\n\r\n    function ignoreChange() {\r\n        ignoreHash++;\r\n        ignoreTime = new Date().getTime();\r\n    }\r\n\r\n    window.addEventListener(\"hashchange\", hashChange as any, false);\r\n\r\n    let routerOrder = 1;\r\n\r\n    $(document).on(\"dialogopen panelopen\", \".ui-dialog-content, .s-Panel\", function (event, ui) {\r\n        if (!enabled)\r\n            return;\r\n\r\n        var dlg = $(event.target);\r\n        dlg.data(\"qrouterorder\", routerOrder++);\r\n\r\n        if (dlg.data(\"qroute\"))\r\n            return;\r\n\r\n        dlg.data(\"qprhash\", window.location.hash);\r\n        var owner = $(visibleDialogs).not(dlg).last();\r\n        if (!owner.length)\r\n            owner = $('html');\r\n\r\n        dialogOpen(owner, dlg, () => {\r\n            return \"!\" + (++autoinc).toString(36);\r\n        });\r\n    });\r\n}","namespace Q {\r\n\r\n    export function autoFullHeight(element: JQuery) {\r\n        element.css('height', '100%');\r\n        triggerLayoutOnShow(element);\r\n    }\r\n\r\n    export function initFullHeightGridPage(gridDiv: JQuery) {\r\n        $('body').addClass('full-height-page');\r\n        gridDiv.addClass('responsive-height');\r\n\r\n        let layout = function () {\r\n            let inPageContent = gridDiv.parent().hasClass('page-content') ||\r\n                gridDiv.parent().is('section.content');\r\n\r\n            if (inPageContent) {\r\n                gridDiv.css('height', '1px').css('overflow', 'hidden');\r\n            }\r\n\r\n            layoutFillHeight(gridDiv);\r\n\r\n            if (inPageContent) {\r\n                gridDiv.css('overflow', '');\r\n            }\r\n\r\n            gridDiv.triggerHandler('layout');\r\n        };\r\n\r\n        if ($('body').hasClass('has-layout-event')) {\r\n            $('body').bind('layout', layout);\r\n        }\r\n        else if ((window as any).Metronic) {\r\n            (window as any).Metronic.addResizeHandler(layout);\r\n        }\r\n        else {\r\n            $(window).resize(layout);\r\n        }\r\n\r\n        layout();\r\n\r\n        gridDiv.one('remove', () => {\r\n            $(window).off('layout', layout);\r\n            $('body').off('layout', layout);\r\n        });\r\n\r\n        // ugly, but to it is to make old pages work without having to add this\r\n        Q[\"Router\"] && Q[\"Router\"].resolve && Q[\"Router\"].resolve();\r\n    }\r\n\r\n    export function layoutFillHeightValue(element: JQuery) {\r\n        let h = 0;\r\n        element.parent().children().not(element).each(function (i, e) {\r\n            let q = $(e);\r\n            if (q.is(':visible')) {\r\n                h += q.outerHeight(true);\r\n            }\r\n        });\r\n        h = element.parent().height() - h;\r\n        if (element.css('box-sizing') !== 'border-box') {\r\n            h = h - (element.outerHeight(true) - element.height());\r\n        }\r\n        return h;\r\n    }\r\n\r\n    export function layoutFillHeight(element: JQuery) {\r\n        let h = layoutFillHeightValue(element);\r\n        let n = Math.round(h) + 'px';\r\n        if (element.css('height') != n) {\r\n            element.css('height', n);\r\n        }\r\n    }\r\n\r\n    export function setMobileDeviceMode() {\r\n        let isMobile = navigator.userAgent.indexOf('Mobi') >= 0 ||\r\n            (window.matchMedia && window.matchMedia('(max-width: 767px)').matches);\r\n\r\n        let body = $(document.body);\r\n        if (body.hasClass('mobile-device')) {\r\n            if (!isMobile) {\r\n                body.removeClass('mobile-device');\r\n            }\r\n        }\r\n        else if (isMobile) {\r\n            body.addClass('mobile-device');\r\n        }\r\n    }\r\n\r\n    setMobileDeviceMode();\r\n    $(function() {\r\n        if (globalObj && Q.Config.rootNamespaces) {\r\n            for (var ns of Q.Config.rootNamespaces) {\r\n                var obj = getNested(globalObj, ns);\r\n                if (obj != null)\r\n                    initializeTypes(obj, ns + \".\", 3);\r\n            }\r\n        }\r\n\r\n        globalObj && $(globalObj).bind('resize', function () {\r\n            setMobileDeviceMode();\r\n        });\r\n    });\r\n\r\n    export function triggerLayoutOnShow(element: JQuery) {\r\n        Serenity.LazyLoadHelper.executeEverytimeWhenShown(element, function () {\r\n            element.triggerHandler('layout');\r\n        }, true);\r\n    }\r\n\r\n    export function centerDialog(el: JQuery) {\r\n        if (!el.hasClass(\"ui-dialog\"))\r\n            el = el.closest(\".ui-dialog\");\r\n\r\n        el.position({ at: 'center center', of: window });\r\n        let pos = el.position();\r\n        if (pos.left < 0)\r\n            el.css(\"left\", \"0px\");\r\n        if (pos.top < 0)\r\n            el.css(\"top\", \"0px\");\r\n    }\r\n}","namespace Serenity.DialogExtensions {\r\n\r\n    export function dialogResizable(dialog: JQuery, w?: any, h?: any, mw?: any, mh?: any): JQuery {\r\n        var dlg = dialog.dialog();\r\n        dlg.dialog('option', 'resizable', true);\r\n        if (mw != null) {\r\n            dlg.dialog('option', 'minWidth', mw);\r\n        }\r\n        if (w != null) {\r\n            dlg.dialog('option', 'width', w);\r\n        }\r\n        if (mh != null) {\r\n            dlg.dialog('option', 'minHeight', mh);\r\n        }\r\n        if (h != null) {\r\n            dlg.dialog('option', 'height', h);\r\n        }\r\n        return dialog;\r\n    }\r\n\r\n    export function dialogMaximizable(dialog: JQuery): JQuery {\r\n        (dialog as any).dialogExtend({\r\n            closable: true,\r\n            maximizable: true,\r\n            dblclick: 'maximize',\r\n            icons: { maximize: 'ui-icon-maximize-window' }\r\n        });\r\n\r\n        return dialog;\r\n    }\r\n}    ","namespace Serenity {\r\n\r\n    @Serenity.Decorators.registerClass([Serenity.IDialog])\r\n    export class TemplatedDialog<TOptions> extends TemplatedWidget<TOptions> {\r\n\r\n        protected tabs: JQuery;\r\n        protected toolbar: Serenity.Toolbar;\r\n        protected validator: JQueryValidation.Validator;\r\n\r\n        constructor(options?: TOptions) {\r\n            super(Q.newBodyDiv().addClass('s-TemplatedDialog hidden'), options);\r\n\r\n            this.element.attr(\"id\", this.uniqueName);\r\n\r\n            this.initValidator();\r\n            this.initTabs();\r\n            this.initToolbar();\r\n        }\r\n\r\n        private get isMarkedAsPanel() {\r\n            var panelAttr = Q.getAttributes(Q.getInstanceType(this),\r\n                Serenity.PanelAttribute, true) as Serenity.PanelAttribute[];\r\n            return panelAttr.length > 0 && panelAttr[panelAttr.length - 1].value !== false;\r\n        }\r\n\r\n        private get isResponsive() {\r\n            return Q.Config.responsiveDialogs ||\r\n                Q.getAttributes(Q.getInstanceType(this), ResponsiveAttribute, true).length > 0;\r\n        }\r\n\r\n        private static getCssSize(element: JQuery, name: string): number {\r\n            var cssSize = element.css(name);\r\n            if (cssSize == null) {\r\n                return null;\r\n            }\r\n\r\n            if (!Q.endsWith(cssSize, 'px')) {\r\n                return null;\r\n            }\r\n\r\n            cssSize = cssSize.substr(0, cssSize.length - 2);\r\n            let i = Q.parseInteger(cssSize);\r\n            if (i == null || isNaN(i) || i == 0)\r\n                return null;\r\n\r\n            return i;\r\n        }\r\n\r\n        private static applyCssSizes(opt: JQueryUI.DialogOptions, dialogClass: string) {\r\n            let size: number;\r\n            let dialog = $('<div/>').hide().addClass(dialogClass).appendTo(document.body);\r\n            try {\r\n                var sizeHelper = $('<div/>').addClass('size').appendTo(dialog);\r\n                size = TemplatedDialog.getCssSize(sizeHelper, 'minWidth'); \r\n                if (size != null)\r\n                    opt.minWidth = size;\r\n\r\n                size = TemplatedDialog.getCssSize(sizeHelper, 'width');\r\n                if (size != null)\r\n                    opt.width = size;\r\n\r\n                size = TemplatedDialog.getCssSize(sizeHelper, 'height');\r\n                if (size != null)\r\n                    opt.height = size;\r\n\r\n                size = TemplatedDialog.getCssSize(sizeHelper, 'minHeight');\r\n                if (size != null)\r\n                    opt.minHeight = size;\r\n            }\r\n            finally {\r\n                dialog.remove();\r\n            }\r\n        };\r\n\r\n        public destroy(): void {\r\n            this.tabs && this.tabs.tabs('destroy');\r\n            this.tabs = null;\r\n            this.toolbar && this.toolbar.destroy();\r\n            this.toolbar = null;\r\n            this.validator && this.byId('Form').remove();\r\n            this.validator = null;\r\n            if (this.element != null &&\r\n                this.element.hasClass('ui-dialog-content')) {\r\n                this.element.dialog('destroy');\r\n                this.element.removeClass('ui-dialog-content');\r\n            }\r\n            else if (this.element != null &&\r\n                this.element.hasClass('modal-body')) {\r\n                var modal = this.element.closest('.modal').data('bs.modal', null);\r\n                this.element && this.element.removeClass('modal-body');\r\n                window.setTimeout(() => modal.remove(), 0);\r\n            }\r\n            \r\n            $(window).unbind('.' + this.uniqueName);\r\n            super.destroy();\r\n        }\r\n\r\n        protected initDialog(): void {\r\n            if (this.element.hasClass('ui-dialog-content'))\r\n                return;\r\n\r\n            this.element.removeClass('hidden');\r\n\r\n            this.element.dialog(this.getDialogOptions());\r\n            this.element.closest('.ui-dialog').on('resize', e => this.arrange());\r\n\r\n            let type = Q.getInstanceType(this);\r\n\r\n            if (this.isResponsive) {\r\n                DialogExtensions.dialogResizable(this.element);\r\n\r\n                $(window).bind('resize.' + this.uniqueName, e => {\r\n                    if (this.element && this.element.is(':visible')) {\r\n                        this.handleResponsive();\r\n                    }\r\n                });\r\n\r\n                this.element.closest('.ui-dialog').addClass('flex-layout');\r\n            }\r\n\r\n            if (Q.getAttributes(type, MaximizableAttribute, true).length > 0) {\r\n                DialogExtensions.dialogMaximizable(this.element);\r\n            }\r\n\r\n            var self = this;\r\n            this.element.bind('dialogopen.' + this.uniqueName, () => {\r\n                $(document.body).addClass('modal-dialog-open');\r\n\r\n                if (this.isResponsive) {\r\n                    this.handleResponsive();\r\n                }\r\n\r\n                self.onDialogOpen();\r\n            });\r\n\r\n            this.element.bind('dialogclose.' + this.uniqueName, () => {\r\n                $(document.body).toggleClass('modal-dialog-open', $('.ui-dialog:visible').length > 0);\r\n                self.onDialogClose();\r\n            });\r\n        }\r\n\r\n        protected getModalOptions(): ModalOptions {\r\n            return {\r\n                backdrop: false,\r\n                keyboard: false,\r\n                size: 'lg',\r\n                modalClass: this.getCssClass()\r\n            }\r\n        }\r\n\r\n        protected initModal(): void {\r\n            if (this.element.hasClass('modal-body'))\r\n                return;\r\n            \r\n            var title = Q.coalesce(this.element.data('dialogtitle'), this.getDialogTitle()) || '';\r\n            var opt = this.getModalOptions();\r\n            opt[\"show\"] = false;\r\n            var modalClass = \"s-Modal\";\r\n            \r\n            if (opt.modalClass)\r\n                modalClass += ' ' + opt.modalClass;\r\n\r\n            var markup = Q.bsModalMarkup(title, '', modalClass);\r\n            var modal = $(markup).eq(0).appendTo(document.body).addClass('flex-layout');\r\n            modal.one('shown.bs.modal.' + this.uniqueName, () => {\r\n                this.element.triggerHandler('shown.bs.modal');\r\n                this.onDialogOpen();\r\n            });\r\n\r\n            modal.one('hidden.bs.modal.' + this.uniqueName, () => {\r\n                $(document.body).toggleClass('modal-open', $('.modal.show').length + $('.modal.in').length > 0);\r\n                this.onDialogClose();\r\n            });\r\n            if (opt.size)\r\n                modal.find('.modal-dialog').addClass('modal-' + opt.size);\r\n\r\n            var footer = modal.find('.modal-footer');\r\n            var buttons = this.getDialogButtons();\r\n            if (buttons != null) {\r\n                for (var x of buttons) {\r\n                    $(Q.dialogButtonToBS(x)).appendTo(footer).click(x.click);\r\n                }\r\n            }\r\n            else\r\n                footer.hide();\r\n\r\n            modal.modal(opt);\r\n            modal.find('.modal-body').replaceWith(this.element.removeClass('hidden').addClass('modal-body'));\r\n            $(window).on('resize.' + this.uniqueName, this.arrange.bind(this));\r\n        }\r\n\r\n        protected initToolbar(): void {\r\n            var toolbarDiv = this.byId('Toolbar');\r\n            if (toolbarDiv.length === 0) {\r\n                return;\r\n            }\r\n\r\n            var hotkeyContext = this.element.closest('.ui-dialog');\r\n            if (hotkeyContext.length === 0) {\r\n                hotkeyContext = this.element.closest('.modal');\r\n                if (hotkeyContext.length == 0)\r\n                    hotkeyContext = this.element;\r\n            }\r\n\r\n            var opt = { buttons: this.getToolbarButtons(), hotkeyContext: hotkeyContext[0] };\r\n            this.toolbar = new Toolbar(toolbarDiv, opt);\r\n        }\r\n\r\n        protected getToolbarButtons(): ToolButton[] {\r\n            return [];\r\n        }\r\n\r\n        protected getValidatorOptions(): JQueryValidation.ValidationOptions {\r\n            return {};\r\n        }\r\n\r\n        protected initValidator(): void {\r\n            var form = this.byId('Form');\r\n            if (form.length > 0) {\r\n                var valOptions = this.getValidatorOptions();\r\n                this.validator = form.validate(Q.validateOptions(valOptions));\r\n            }\r\n        }\r\n\r\n        protected resetValidation() {\r\n            this.validator && (this.validator as any).resetAll();\r\n        }\r\n\r\n        protected validateForm() {\r\n            return this.validator == null || !!this.validator.form();\r\n        }\r\n\r\n        public dialogOpen(asPanel?: boolean): void {\r\n            asPanel = Q.coalesce(asPanel, this.isMarkedAsPanel);\r\n            if (asPanel) {\r\n                if (!this.element.hasClass('s-Panel')) {\r\n                    // so that panel title is created if needed\r\n                    this.element.on('panelopen.' + this.uniqueName, () => {\r\n                        this.onDialogOpen();\r\n                    });\r\n                    this.element.on('panelclose.' + this.uniqueName, () => {\r\n                        this.onDialogClose();\r\n                    });\r\n                }\r\n\r\n                TemplatedDialog.openPanel(this.element, this.uniqueName);\r\n                this.setupPanelTitle();\r\n            }\r\n            else if (this.useBSModal()) {\r\n                this.initModal();\r\n                this.element.closest('.modal').modal('show');\r\n            }\r\n            else {\r\n                this.initDialog();\r\n                this.element.dialog('open');\r\n            }\r\n        }\r\n\r\n        private useBSModal() {\r\n            return !!((!$.ui || !$.ui.dialog) || TemplatedDialog.bootstrapModal);\r\n        }\r\n\r\n        public static bootstrapModal: boolean;\r\n\r\n        public static openPanel(element: JQuery, uniqueName: string) {\r\n            var container = $('.panels-container');\r\n            if (!container.length)\r\n                container = $('section.content');\r\n\r\n            element.data('paneluniquename', uniqueName);\r\n\r\n            if (container.length) {\r\n                container = container.last();\r\n                container.children()\r\n                    .not(element)\r\n                    .not('.panel-hidden')\r\n                    .addClass('panel-hidden panel-hidden-' + uniqueName);\r\n\r\n                if (element[0].parentElement !== container[0])\r\n                    element.appendTo(container);\r\n            }\r\n\r\n            $('.ui-dialog:visible, .ui-widget-overlay:visible, .modal.show, .modal.in')\r\n                .not(element)\r\n                .addClass('panel-hidden panel-hidden-' + uniqueName);\r\n\r\n            element\r\n                .removeClass('hidden')\r\n                .removeClass('panel-hidden')\r\n                .addClass('s-Panel')\r\n                .trigger('panelopen');\r\n        }\r\n\r\n        public static closePanel(element: JQuery, e?: JQueryEventObject) {\r\n            if (!element.hasClass('s-Panel') || element.hasClass('hidden'))\r\n                return;\r\n\r\n            var query = $.Event(e as any);\r\n            (query as any).type = 'panelbeforeclose';\r\n            query.target = element[0];\r\n            element.trigger(query);\r\n            if (query.isDefaultPrevented())\r\n                return;\r\n\r\n            element.addClass('hidden');\r\n            var uniqueName = element.data('paneluniquename') || new Date().getTime();\r\n            var klass = 'panel-hidden-' + uniqueName;\r\n            $('.' + klass).removeClass(klass).removeClass('panel-hidden');\r\n            $(window).triggerHandler('resize');\r\n            $('.require-layout:visible').triggerHandler('layout');\r\n\r\n            var e = $.Event(e as any);\r\n            (e as any).type = 'panelclose';\r\n            (e as any).target = element[0];\r\n            element.trigger(e);\r\n        }\r\n\r\n        protected onDialogOpen(): void {\r\n            if (!$(document.body).hasClass('mobile-device'))\r\n                $(':input', this.element).not('button').eq(0).focus();\r\n            this.arrange();\r\n            this.tabs && this.tabs.tabs('option', 'active', 0);\r\n        }\r\n\r\n        protected arrange(): void {\r\n            this.element.find('.require-layout').filter(':visible').each(function (i, e) {\r\n                $(e).triggerHandler('layout');\r\n            });\r\n        }\r\n\r\n        protected onDialogClose() {\r\n            $(document).trigger('click');\r\n\r\n            // for tooltips etc.\r\n            if (($ as any).qtip) {\r\n                $(document.body).children('.qtip').each(function (index, el) {\r\n                    ($(el) as any).qtip('hide');\r\n                });\r\n            }\r\n\r\n            window.setTimeout(() => {\r\n                var element = this.element;\r\n                this.destroy();\r\n                element.remove();\r\n                Q.positionToastContainer(false);\r\n            }, 0);\r\n        }\r\n\r\n        protected addCssClass(): void {\r\n            if (this.isMarkedAsPanel) {\r\n                super.addCssClass();\r\n\r\n                if (this.isResponsive)\r\n                    this.element.addClass(\"flex-layout\");\r\n            }\r\n        }\r\n\r\n        protected getDialogButtons(): Q.DialogButton[] {\r\n            return undefined;\r\n        }\r\n\r\n        protected getDialogOptions(): JQueryUI.DialogOptions {\r\n            var opt: JQueryUI.DialogOptions = {};\r\n            var dialogClass = 's-Dialog ' + this.getCssClass();\r\n            opt.dialogClass = dialogClass;\r\n            var buttons = this.getDialogButtons();\r\n            if (buttons != null)\r\n                opt.buttons = buttons.map(Q.dialogButtonToUI);\r\n            opt.width = 920;\r\n            TemplatedDialog.applyCssSizes(opt, dialogClass);\r\n            opt.autoOpen = false;\r\n            let type = Q.getInstanceType(this);\r\n            opt.resizable = Q.getAttributes(type, Serenity.ResizableAttribute, true).length > 0;\r\n            opt.modal = true;\r\n            opt.position = { my: 'center', at: 'center', of: $(window.window) };\r\n            opt.title = Q.coalesce(this.element.data('dialogtitle'), this.getDialogTitle()) || '';\r\n            return opt;\r\n        }\r\n\r\n        protected getDialogTitle() {\r\n            return \"\";\r\n        }\r\n\r\n        public dialogClose(): void {\r\n            if (this.element.hasClass('ui-dialog-content'))\r\n                this.element.dialog().dialog('close');\r\n            else if (this.element.hasClass('modal-body'))\r\n                this.element.closest('.modal').modal('hide');\r\n            else if (this.element.hasClass('s-Panel') && !this.element.hasClass('hidden')) {\r\n                TemplatedDialog.closePanel(this.element);\r\n            }\r\n        }\r\n\r\n        public get dialogTitle(): string {\r\n            if (this.element.hasClass('ui-dialog-content'))\r\n                return this.element.dialog('option', 'title');\r\n            else if (this.element.hasClass('modal-body'))\r\n                return this.element.closest('.modal').find('.modal-header').children('h5').text();\r\n\r\n            return this.element.data('dialogtitle');\r\n        }\r\n\r\n        private setupPanelTitle() {\r\n            var value = Q.coalesce(this.dialogTitle, this.getDialogTitle());\r\n            var pt = this.element.children('.panel-titlebar');\r\n\r\n            if (Q.isEmptyOrNull(value)) {\r\n                pt.remove();\r\n            }\r\n            else {\r\n                if (!this.element.children('.panel-titlebar').length) {\r\n                    pt = $(\"<div class='panel-titlebar'><div class='panel-titlebar-text'></div></div>\")\r\n                        .prependTo(this.element);\r\n                }\r\n                pt.children('.panel-titlebar-text').text(value);\r\n\r\n                if (this.element.hasClass('s-Panel')) {\r\n                    if (!pt.children('.panel-titlebar-close').length) {\r\n                        $('<button class=\"panel-titlebar-close\">&nbsp;</button>')\r\n                            .prependTo(pt)\r\n                            .click(e => {\r\n                                TemplatedDialog.closePanel(this.element, e);\r\n                            });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        public set dialogTitle(value: string) {\r\n            var oldTitle = this.dialogTitle;\r\n            this.element.data('dialogtitle', value);\r\n\r\n            if (this.element.hasClass('ui-dialog-content'))\r\n                this.element.dialog('option', 'title', value);\r\n            else if (this.element.hasClass('modal-body')) {\r\n                this.element.closest('.modal').find('.modal-header').children('h5').text(value ?? '');\r\n            }\r\n            else if (this.element.hasClass('s-Panel')) {\r\n                if (oldTitle != this.dialogTitle) {\r\n                    this.setupPanelTitle();\r\n                    this.arrange();\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        public set_dialogTitle(value: string) {\r\n            this.dialogTitle = value;\r\n        }\r\n\r\n        protected initTabs(): void {\r\n            var tabsDiv = this.byId('Tabs');\r\n            if (tabsDiv.length === 0) {\r\n                return;\r\n            }\r\n            this.tabs = tabsDiv.tabs({});\r\n            this.tabs.bind('tabsactivate', () => this.arrange());\r\n        }\r\n\r\n        protected handleResponsive(): void {\r\n            var dlg = this.element.dialog();\r\n            var uiDialog = this.element.closest('.ui-dialog');\r\n            if ($(document.body).hasClass('mobile-device')) {\r\n                var data = this.element.data('responsiveData');\r\n                if (!data) {\r\n                    data = {};\r\n                    data.draggable = dlg.dialog('option', 'draggable');\r\n                    data.resizable = dlg.dialog('option', 'resizable');\r\n                    data.position = dlg.css('position');\r\n                    var pos = uiDialog.position();\r\n                    data.left = pos.left;\r\n                    data.top = pos.top;\r\n                    data.width = uiDialog.width();\r\n                    data.height = uiDialog.height();\r\n                    data.contentHeight = this.element.height();\r\n                    this.element.data('responsiveData', data);\r\n                    dlg.dialog('option', 'draggable', false);\r\n                    dlg.dialog('option', 'resizable', false);\r\n                }\r\n                uiDialog.addClass('mobile-layout');\r\n                uiDialog.css({ left: '0px', top: '0px', width: $(window).width() + 'px', height: $(window).height() + 'px', position: 'fixed' });\r\n                $(document.body).scrollTop(0);\r\n                Q.layoutFillHeight(this.element);\r\n            }\r\n            else {\r\n                var d = this.element.data('responsiveData');\r\n                if (d) {\r\n                    dlg.dialog('option', 'draggable', d.draggable);\r\n                    dlg.dialog('option', 'resizable', d.resizable);\r\n                    this.element.closest('.ui-dialog').css({ left: '0px', top: '0px', width: d.width + 'px', height: d.height + 'px', position: d.position });\r\n                    this.element.height(d.contentHeight);\r\n                    uiDialog.removeClass('mobile-layout');\r\n                    this.element.removeData('responsiveData');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    export interface ModalOptions {\r\n        backdrop?: boolean | 'static',\r\n        keyboard?: boolean,\r\n        size?: 'lg' | 'sm',\r\n        modalClass?: string;\r\n    }\r\n}","namespace Serenity {\r\n\r\n    export type DialogButton = JQueryUI.DialogButtonOptions;\r\n\r\n    @Decorators.registerClass('Serenity.PropertyDialog')\r\n    export class PropertyDialog<TItem, TOptions> extends TemplatedDialog<TOptions> {\r\n        protected _entity: TItem;\r\n        protected _entityId: any;\r\n\r\n        constructor(opt?: TOptions) {\r\n            super(opt);\r\n\r\n            this.initPropertyGrid();\r\n            this.loadInitialEntity();\r\n        }\r\n\r\n        destroy() {\r\n            if (this.propertyGrid) {\r\n                this.propertyGrid.destroy();\r\n                this.propertyGrid = null;\r\n            }\r\n\r\n            if (this.validator) {\r\n                this.byId('Form').remove();\r\n                this.validator = null;\r\n            }\r\n\r\n            super.destroy();\r\n        }\r\n\r\n        protected getDialogOptions() {\r\n            var opt = super.getDialogOptions();\r\n            opt.width = 400;\r\n            return opt;\r\n        }\r\n\r\n        protected getDialogButtons() {\r\n            return [{\r\n                text: Q.text('Dialogs.OkButton'),\r\n                click: () => this.okClick()\r\n            }, {\r\n                text: Q.text('Dialogs.CancelButton'),\r\n                click: () => this.cancelClick()\r\n            }];\r\n        }\r\n\r\n        protected okClick() {\r\n            if (!this.validateBeforeSave()) {\r\n                return;\r\n            }\r\n\r\n            this.okClickValidated();\r\n        }\r\n\r\n        protected okClickValidated() {\r\n            this.dialogClose();\r\n        }\r\n\r\n        protected cancelClick() {\r\n            this.dialogClose();\r\n        }\r\n\r\n        protected initPropertyGrid() {\r\n            var pgDiv = this.byId('PropertyGrid');\r\n            if (pgDiv.length <= 0) {\r\n                return;\r\n            }\r\n            var pgOptions = this.getPropertyGridOptions();\r\n            this.propertyGrid = (new Serenity.PropertyGrid(pgDiv, pgOptions)).init(null);\r\n            if (this.element.closest('.ui-dialog').hasClass('s-Flexify')) {\r\n                this.propertyGrid.element.children('.categories').flexHeightOnly(1);\r\n            }\r\n        }\r\n\r\n        protected getFormKey(): string {\r\n            var attributes = Q.getAttributes(\r\n                Q.getInstanceType(this), Serenity.FormKeyAttribute, true);\r\n            if (attributes.length >= 1) {\r\n                return attributes[0].value;\r\n            }\r\n            else {\r\n                var name = Q.getTypeFullName(Q.getInstanceType(this));\r\n                var px = name.indexOf('.');\r\n                if (px >= 0) {\r\n                    name = name.substring(px + 1);\r\n                }\r\n                if (Q.endsWith(name, 'Dialog')) {\r\n                    name = name.substr(0, name.length - 6);\r\n                }\r\n                else if (Q.endsWith(name, 'Panel')) {\r\n                    name = name.substr(0, name.length - 5);\r\n                }\r\n                return name;\r\n            }\r\n        }\r\n\r\n        protected getPropertyGridOptions(): PropertyGridOptions {\r\n            return {\r\n                idPrefix: this.idPrefix,\r\n                items: this.getPropertyItems(),\r\n                mode: 1,\r\n                useCategories: false,\r\n                localTextPrefix: 'Forms.' + this.getFormKey() + '.'\r\n            };\r\n        }\r\n\r\n        protected getPropertyItems(): PropertyItem[] {\r\n            var formKey = this.getFormKey();\r\n            return Q.getForm(formKey);\r\n        }\r\n\r\n        protected getSaveEntity(): TItem {\r\n            var entity = new Object();\r\n            if (this.propertyGrid) {\r\n                this.propertyGrid.save(entity);\r\n            }\r\n            return entity as TItem;\r\n        }\r\n\r\n        protected loadInitialEntity(): void {\r\n            this.propertyGrid && this.propertyGrid.load(new Object());\r\n        }\r\n\r\n        protected get_entity() {\r\n            return this._entity;\r\n        }\r\n\r\n        protected set_entity(value: TItem) {\r\n            this._entity = Q.coalesce(value, new Object()) as any;\r\n        }\r\n\r\n        protected get_entityId() {\r\n            return this._entityId;\r\n        }\r\n\r\n        protected set_entityId(value: any): void {\r\n            this._entityId = value;\r\n        }\r\n\r\n        protected validateBeforeSave(): boolean {\r\n            return this.validator.form();\r\n        }\r\n\r\n        protected updateTitle() {\r\n        }\r\n\r\n        protected propertyGrid: Serenity.PropertyGrid;\r\n    }\r\n}","namespace Serenity {\r\n\r\n\r\n    @Serenity.Decorators.registerClass('Serenity.EntityDialog', [Serenity['IEditDialog'], IReadOnly])\r\n    export class EntityDialog<TItem, TOptions> extends TemplatedDialog<TOptions> implements IEditDialog, IReadOnly {\r\n\r\n        protected entity: TItem;\r\n        protected entityId: any;\r\n        protected propertyGrid: PropertyGrid;\r\n\r\n        protected toolbar: Toolbar;\r\n        protected saveAndCloseButton: JQuery;\r\n        protected applyChangesButton: JQuery;\r\n        protected deleteButton: JQuery;\r\n        protected undeleteButton: JQuery;\r\n        protected cloneButton: JQuery;\r\n        protected editButton: JQuery;\r\n\r\n        protected localizationGrid: PropertyGrid;\r\n        protected localizationButton: JQuery;\r\n        protected localizationPendingValue: any;\r\n        protected localizationLastValue: any;\r\n\r\n        static defaultLanguageList: () => string[][];\r\n\r\n        constructor(opt?: TOptions) {\r\n            super(opt);\r\n\r\n            this.initPropertyGrid();\r\n            this.initLocalizationGrid();\r\n        }\r\n\r\n        destroy(): void {\r\n\r\n            if (this.propertyGrid) {\r\n                this.propertyGrid.destroy();\r\n                this.propertyGrid = null;\r\n            }\r\n\r\n            if (this.localizationGrid) {\r\n                this.localizationGrid.destroy();\r\n                this.localizationGrid = null;\r\n            }\r\n\r\n            this.undeleteButton = null;\r\n            this.applyChangesButton = null;\r\n            this.deleteButton = null;\r\n            this.saveAndCloseButton = null;\r\n            this.editButton = null;\r\n            this.cloneButton = null;\r\n            this.toolbar = null;\r\n\r\n            super.destroy();\r\n        }\r\n\r\n        protected get_entity(): TItem {\r\n            return this.entity;\r\n        }\r\n\r\n        protected set_entity(entity: any): void {\r\n            this.entity = entity || new Object();\r\n        }\r\n\r\n        protected get_entityId(): any {\r\n            return this.entityId;\r\n        }\r\n\r\n        protected set_entityId(value: any) {\r\n            this.entityId = value;\r\n        }\r\n\r\n        protected getEntityNameFieldValue(): any {\r\n            return Q.coalesce(this.get_entity()[this.getNameProperty()], '').toString();\r\n        }\r\n\r\n        protected getEntityTitle(): string {\r\n            if (!this.isEditMode()) {\r\n                return Q.format(Q.text('Controls.EntityDialog.NewRecordTitle'), this.getEntitySingular());\r\n            }\r\n            else {\r\n                var titleFormat = (this.isViewMode() || this.readOnly || !this.hasSavePermission()) ?\r\n                    Q.text('Controls.EntityDialog.ViewRecordTitle') : Q.text('Controls.EntityDialog.EditRecordTitle');\r\n                var title = Q.coalesce(this.getEntityNameFieldValue(), '');\r\n                return Q.format(titleFormat,\r\n                    this.getEntitySingular(), (Q.isEmptyOrNull(title) ? '' : (' (' + title + ')')));\r\n            }\r\n        }\r\n\r\n        protected updateTitle(): void {\r\n            this.dialogTitle = this.getEntityTitle();\r\n        }\r\n\r\n        protected isCloneMode(): boolean {\r\n            return false;\r\n        }\r\n\r\n        protected isEditMode(): boolean {\r\n            return this.get_entityId() != null && !this.isCloneMode();\r\n        }\r\n\r\n        protected isDeleted(): boolean {\r\n            if (this.get_entityId() == null) {\r\n                return false;\r\n            }\r\n\r\n            var isDeletedProperty = this.getIsDeletedProperty();\r\n            if (isDeletedProperty) {\r\n                return !!this.get_entity()[isDeletedProperty];\r\n            }\r\n\r\n            var value = this.get_entity()[this.getIsActiveProperty()];\r\n            if (value == null) {\r\n                return false;\r\n            }\r\n\r\n            return value < 0;\r\n        }\r\n\r\n        protected isNew(): boolean {\r\n            return this.get_entityId() == null;\r\n        }\r\n\r\n        protected isNewOrDeleted(): boolean {\r\n            return this.isNew() || this.isDeleted();\r\n        }\r\n\r\n        protected getDeleteOptions(callback: (response: DeleteResponse) => void): ServiceOptions<DeleteResponse> {\r\n            return {};\r\n        }\r\n\r\n        protected deleteHandler(options: ServiceOptions<DeleteResponse>, callback: (response: DeleteResponse) => void): void {\r\n            Q.serviceCall(options);\r\n        }\r\n\r\n        protected doDelete(callback: (response: DeleteResponse) => void): void {\r\n            var self = this;\r\n\r\n            var request: DeleteRequest = {\r\n                EntityId: this.get_entityId()\r\n            };\r\n\r\n            var baseOptions: Q.ServiceOptions<DeleteResponse> = {\r\n                service: this.getService() + '/Delete',\r\n                request: request,\r\n                onSuccess: response => {\r\n                    self.onDeleteSuccess(response);\r\n                    if (callback != null) {\r\n                        callback(response);\r\n                    }\r\n                    self.element.triggerHandler('ondatachange', [{\r\n                        entityId: request.EntityId,\r\n                        entity: this.entity,\r\n                        type: 'delete'\r\n                    }]);\r\n                }\r\n            };\r\n\r\n            var thisOptions = this.getDeleteOptions(callback);\r\n            var finalOptions = Q.extend(baseOptions, thisOptions);\r\n\r\n            this.deleteHandler(finalOptions, callback);\r\n        }\r\n\r\n        protected onDeleteSuccess(response: DeleteResponse): void {\r\n        }\r\n\r\n        protected attrs<TAttr>(attrType: { new(...args: any[]): TAttr }): TAttr[] {\r\n            return Q.getAttributes(Q.getInstanceType(this), attrType, true);\r\n        }\r\n\r\n        private entityType: string;\r\n\r\n        protected getEntityType(): string {\r\n\r\n            if (this.entityType != null)\r\n                return this.entityType;\r\n\r\n            var typeAttributes = this.attrs(EntityTypeAttribute);\r\n\r\n            if (typeAttributes.length === 1)\r\n                return (this.entityType = typeAttributes[0].value);\r\n\r\n            // remove global namespace\r\n            var name = Q.getTypeFullName(Q.getInstanceType(this));\r\n            var px = name.indexOf('.');\r\n            if (px >= 0)\r\n                name = name.substring(px + 1);\r\n\r\n            // don't like this kind of convention, make it obsolete soon...\r\n            if (Q.endsWith(name, 'Dialog') || Q.endsWith(name, 'Control'))\r\n                name = name.substr(0, name.length - 6);\r\n            else if (Q.endsWith(name, 'Panel'))\r\n                name = name.substr(0, name.length - 5);\r\n\r\n            return (this.entityType = name);\r\n        }\r\n\r\n        private formKey: string;\r\n\r\n        protected getFormKey(): string {\r\n            if (this.formKey != null)\r\n                return this.formKey;\r\n\r\n            var attributes = this.attrs(FormKeyAttribute);\r\n\r\n            if (attributes.length >= 1)\r\n                return (this.formKey = attributes[0].value);\r\n\r\n            return (this.formKey = this.getEntityType());\r\n        }\r\n\r\n        private localTextDbPrefix: string;\r\n\r\n        protected getLocalTextDbPrefix(): string {\r\n            if (this.localTextDbPrefix != null)\r\n                return this.localTextDbPrefix;\r\n\r\n            this.localTextDbPrefix = Q.coalesce(this.getLocalTextPrefix(), '');\r\n\r\n            if (this.localTextDbPrefix.length > 0 && !Q.endsWith(this.localTextDbPrefix, '.'))\r\n                this.localTextDbPrefix = 'Db.' + this.localTextDbPrefix + '.';\r\n\r\n            return this.localTextDbPrefix;\r\n        }\r\n\r\n        protected getLocalTextPrefix(): string {\r\n            var attributes = this.attrs(LocalTextPrefixAttribute);\r\n\r\n            if (attributes.length >= 1)\r\n                return attributes[0].value;\r\n\r\n            return this.getEntityType();\r\n        }\r\n\r\n        private entitySingular: string;\r\n\r\n        protected getEntitySingular(): string {\r\n            if (this.entitySingular != null)\r\n                return this.entitySingular;\r\n\r\n            var attributes = this.attrs(ItemNameAttribute);\r\n\r\n            if (attributes.length >= 1) {\r\n                this.entitySingular = attributes[0].value;\r\n                this.entitySingular = Q.LT.getDefault(this.entitySingular, this.entitySingular);\r\n            }\r\n            else {\r\n                var es = Q.tryGetText(this.getLocalTextDbPrefix() + 'EntitySingular');\r\n                if (es == null) \r\n                    es = this.getEntityType();\r\n                this.entitySingular = es;\r\n            }\r\n\r\n            return this.entitySingular;\r\n        }\r\n\r\n        private nameProperty: string;\r\n\r\n        protected getNameProperty(): string {\r\n            if (this.nameProperty != null)\r\n                return this.nameProperty;\r\n\r\n            var attributes = this.attrs(NamePropertyAttribute);\r\n\r\n            if (attributes.length >= 1)\r\n                this.nameProperty = attributes[0].value;\r\n            else\r\n                this.nameProperty = 'Name';\r\n\r\n            return this.nameProperty;\r\n        }\r\n\r\n        private idProperty: string;\r\n\r\n        protected getIdProperty(): string {\r\n            if (this.idProperty != null)\r\n                return this.idProperty;\r\n\r\n            var attributes = this.attrs(IdPropertyAttribute);\r\n            if (attributes.length >= 1)\r\n                this.idProperty = attributes[0].value;\r\n            else\r\n                this.idProperty = 'ID';\r\n\r\n            return this.idProperty;\r\n        }\r\n\r\n        protected isActiveProperty: string;\r\n\r\n        protected getIsActiveProperty(): string {\r\n            if (this.isActiveProperty != null)\r\n                return this.isActiveProperty;\r\n\r\n            var attributes = this.attrs(IsActivePropertyAttribute)\r\n            if (attributes.length >= 1)\r\n                this.isActiveProperty = attributes[0].value;\r\n            else\r\n                this.isActiveProperty = 'IsActive';\r\n\r\n            return this.isActiveProperty;\r\n        }\r\n\r\n        protected getIsDeletedProperty(): string {\r\n            return null;\r\n        }\r\n\r\n        protected service: string;\r\n\r\n        protected getService() {\r\n            if (this.service != null)\r\n                return this.service;\r\n\r\n            var attributes = this.attrs(ServiceAttribute);\r\n            if (attributes.length >= 1)\r\n                this.service = attributes[0].value;\r\n            else\r\n                this.service = Q.replaceAll(this.getEntityType(), '.', '/');\r\n\r\n            return this.service;\r\n        }\r\n\r\n        load(entityOrId: any, done: () => void, fail: (ex: Q.Exception) => void): void {\r\n\r\n            var action = () => {\r\n\r\n                if (entityOrId == null) {\r\n                    this.loadResponse({});\r\n                    done && done();\r\n                    return;\r\n                }\r\n\r\n                var scriptType = typeof (entityOrId);\r\n                if (scriptType === 'string' || scriptType === 'number') {\r\n                    var entityId = entityOrId;\r\n\r\n                    this.loadById(entityId, function (response) {\r\n                        if (done)\r\n                            window.setTimeout(done, 0);\r\n                    }, null);\r\n\r\n                    return;\r\n                }\r\n\r\n                var entity = entityOrId || new Object();\r\n                this.loadResponse({ Entity: entity });\r\n                done && done();\r\n            };\r\n\r\n            if (fail == null) {\r\n                action();\r\n                return;\r\n            }\r\n\r\n            try {\r\n                action();\r\n            }\r\n            catch (ex1) {\r\n                var ex = (Q.Exception as any).wrap(ex1);\r\n                fail(ex);\r\n            }\r\n        }\r\n\r\n        loadNewAndOpenDialog(asPanel?: boolean): void {\r\n            this.loadResponse({});\r\n            this.dialogOpen(asPanel);\r\n        }\r\n\r\n        loadEntityAndOpenDialog(entity: TItem, asPanel?: boolean): void {\r\n            this.loadResponse({ Entity: entity });\r\n            this.dialogOpen(asPanel);\r\n        }\r\n\r\n        protected loadResponse(data: any): void {\r\n            data = data || {};\r\n            this.onLoadingData(data);\r\n            var entity = data.Entity || new Object();\r\n            this.beforeLoadEntity(entity);\r\n            this.loadEntity(entity);\r\n            this.set_entity(entity);\r\n            this.afterLoadEntity();\r\n        }\r\n\r\n        protected loadEntity(entity: TItem): void {\r\n            var idField = this.getIdProperty();\r\n\r\n            if (idField != null)\r\n                this.set_entityId(entity[idField]);\r\n            \r\n            this.set_entity(entity);\r\n\r\n            if (this.propertyGrid != null) {\r\n                this.propertyGrid.set_mode((this.isEditMode() ?\r\n                    PropertyGridMode.update : PropertyGridMode.insert));\r\n                this.propertyGrid.load(entity);\r\n            }\r\n        }\r\n\r\n        protected beforeLoadEntity(entity: TItem): void {\r\n            this.localizationPendingValue = null;\r\n            this.localizationLastValue = null;\r\n        }\r\n\r\n        protected afterLoadEntity(): void {\r\n            this.updateInterface();\r\n            this.updateTitle();\r\n        }\r\n\r\n        public loadByIdAndOpenDialog(entityId: any, asPanel?: boolean) {\r\n            this.loadById(entityId,\r\n                response => window.setTimeout(() => this.dialogOpen(asPanel), 0),\r\n                () => {\r\n                    if (!this.element.is(':visible')) {\r\n                        this.element.remove();\r\n                    }\r\n                });\r\n        }\r\n\r\n        protected onLoadingData(data: RetrieveResponse<TItem>): void {\r\n        }\r\n\r\n        protected getLoadByIdOptions(id: any, callback: (response: RetrieveResponse<TItem>) => void): ServiceOptions<RetrieveResponse<TItem>> {\r\n            return {};\r\n        }\r\n\r\n        protected getLoadByIdRequest(id: any): RetrieveRequest {\r\n            var request: RetrieveRequest = {};\r\n            request.EntityId = id;\r\n            return request;\r\n        }\r\n\r\n        protected reloadById(): void {\r\n            this.loadById(this.get_entityId());\r\n        }\r\n\r\n        loadById(id: any, callback?: (response: RetrieveResponse<TItem>) => void, fail?: () => void) {\r\n            var baseOptions: Q.ServiceOptions<RetrieveResponse<TItem>> = {\r\n                service: this.getService() + '/Retrieve',\r\n                blockUI: true,\r\n                request: this.getLoadByIdRequest(id),\r\n                onSuccess: response => {\r\n                    this.loadResponse(response);\r\n                    callback && callback(response);\r\n                },\r\n                onCleanup: () => {\r\n                    if (this.validator != null) {\r\n                        Q.validatorAbortHandler(this.validator);\r\n                    }\r\n                }\r\n            };\r\n\r\n            var thisOptions = this.getLoadByIdOptions(id, callback);\r\n            var finalOptions = Q.extend(baseOptions, thisOptions);\r\n            this.loadByIdHandler(finalOptions, callback, fail);\r\n        }\r\n\r\n        protected loadByIdHandler(options: ServiceOptions<RetrieveResponse<TItem>>, callback: (response: RetrieveResponse<TItem>) => void, fail: () => void): void {\r\n            var request = Q.serviceCall(options);\r\n            fail && request.fail(fail);\r\n        }\r\n\r\n        protected initLocalizationGrid(): void {\r\n            var pgDiv = this.byId('PropertyGrid');\r\n            if (pgDiv.length <= 0) {\r\n                return;\r\n            }\r\n            var pgOptions = this.getPropertyGridOptions();\r\n            this.initLocalizationGridCommon(pgOptions);\r\n        }\r\n\r\n        protected initLocalizationGridCommon(pgOptions: PropertyGridOptions) {\r\n            var pgDiv = this.byId('PropertyGrid');\r\n\r\n            if (!Q.any(pgOptions.items, x => x.localizable === true))\r\n                return;\r\n\r\n            var localGridDiv = $('<div/>')\r\n                .attr('id', this.idPrefix + 'LocalizationGrid')\r\n                .hide().insertAfter(pgDiv);\r\n\r\n            pgOptions.idPrefix = this.idPrefix + 'Localization_';\r\n\r\n            var items: PropertyItem[] = [];\r\n            for (var item1 of pgOptions.items) {\r\n                var langs = null;\r\n\r\n                if (item1.localizable === true) {\r\n                    var copy = Q.extend({}, item1);\r\n                    copy.oneWay = true;\r\n                    copy.readOnly = true;\r\n                    copy.required = false;\r\n                    copy.defaultValue = null;\r\n                    items.push(copy);\r\n\r\n                    if (langs == null)\r\n                        langs = this.getLangs();\r\n\r\n                    for (var lang of langs) {\r\n                        copy = Q.extend({}, item1);\r\n                        copy.name = lang[0] + '$' + copy.name;\r\n                        copy.title = lang[1];\r\n                        copy.cssClass = [copy.cssClass, 'translation'].join(' ');\r\n                        copy.insertable = true;\r\n                        copy.updatable = true;\r\n                        copy.oneWay = false;\r\n                        copy.required = false;\r\n                        copy.localizable = false;\r\n                        copy.defaultValue = null;\r\n                        items.push(copy);\r\n                    }\r\n                }\r\n            }\r\n\r\n            pgOptions.items = items;\r\n\r\n            this.localizationGrid = (new Serenity.PropertyGrid(localGridDiv, pgOptions)).init(null);\r\n            localGridDiv.addClass('s-LocalizationGrid');\r\n        }\r\n\r\n        protected isLocalizationMode(): boolean {\r\n            return this.localizationButton != null && this.localizationButton.hasClass('pressed');\r\n        }\r\n\r\n        protected isLocalizationModeAndChanged(): boolean {\r\n            if (!this.isLocalizationMode()) {\r\n                return false;\r\n            }\r\n\r\n            var newValue = this.getLocalizationGridValue();\r\n            return $.toJSON(this.localizationLastValue) !=  $.toJSON(newValue);\r\n        }\r\n\r\n        protected localizationButtonClick(): void {\r\n            if (this.isLocalizationMode() && !this.validateForm()) {\r\n                return;\r\n            }\r\n\r\n            if (this.isLocalizationModeAndChanged()) {\r\n                var newValue = this.getLocalizationGridValue();\r\n                this.localizationLastValue = newValue;\r\n                this.localizationPendingValue = newValue;\r\n            }\r\n\r\n            this.localizationButton.toggleClass('pressed');\r\n            this.updateInterface();\r\n            if (this.isLocalizationMode()) {\r\n                this.loadLocalization();\r\n            }\r\n        }\r\n\r\n        protected getLanguages(): any[] {\r\n            if (Serenity.EntityDialog.defaultLanguageList != null)\r\n                return Serenity.EntityDialog.defaultLanguageList() || [];\r\n\r\n            return [];\r\n        }\r\n\r\n        // for compatibility with older getLanguages methods written in Saltaralle\r\n        private getLangs(): any {\r\n\r\n            var langsTuple = this.getLanguages();\r\n            var langs = Q.safeCast(langsTuple, Array);\r\n            if (langs == null || langs.length === 0 ||\r\n                langs[0] == null || !Q.isArray(langs[0])) {\r\n                langs = Array.prototype.slice.call(langsTuple.map(function (x: any) {\r\n                    return [x.item1, x.item2];\r\n                }));\r\n            }\r\n\r\n            return langs;\r\n        }\r\n\r\n        protected loadLocalization(): void {\r\n            if (this.localizationLastValue == null && this.isNew()) {\r\n                this.localizationGrid.load({});\r\n                this.setLocalizationGridCurrentValues();\r\n                this.localizationLastValue = this.getLocalizationGridValue();\r\n                return;\r\n            }\r\n\r\n            if (this.localizationLastValue != null) {\r\n                this.localizationGrid.load(this.localizationLastValue);\r\n                this.setLocalizationGridCurrentValues();\r\n                return;\r\n            }\r\n\r\n            var opt = <Q.ServiceOptions<any>>{\r\n                service: this.getService() + '/Retrieve',\r\n                blockUI: true,\r\n                request: {\r\n                    EntityId: this.get_entityId(),\r\n                    ColumnSelection: 'keyOnly',\r\n                    IncludeColumns: ['Localizations']\r\n                },\r\n                onSuccess: response => {\r\n                    var copy = Q.extend(new Object(), this.get_entity());\r\n                    if (response.Localizations) {\r\n                        for (var language of Object.keys(response.Localizations)) {\r\n                            var entity = response.Localizations[language];\r\n                            for (var key of Object.keys(entity)) {\r\n                                copy[language + '$' + key] = entity[key];\r\n                            }\r\n                        }\r\n                    }\r\n                    \r\n                    this.localizationGrid.load(copy);\r\n                    this.setLocalizationGridCurrentValues();\r\n                    this.localizationPendingValue = null;\r\n                    this.localizationLastValue = this.getLocalizationGridValue();\r\n                }\r\n            };\r\n\r\n            Q.serviceCall(opt);\r\n        }\r\n\r\n        protected setLocalizationGridCurrentValues(): void {\r\n            var valueByName = {};\r\n\r\n            this.localizationGrid.enumerateItems((item, widget) => {\r\n                if (item.name.indexOf('$') < 0 && widget.element.is(':input')) {\r\n                    valueByName[item.name] = this.byId(item.name).val();\r\n                    widget.element.val(valueByName[item.name]);\r\n                }\r\n            });\r\n\r\n            this.localizationGrid.enumerateItems((item1, widget1) => {\r\n                var idx = item1.name.indexOf('$');\r\n                if (idx >= 0 && widget1.element.is(':input')) {\r\n                    var hint = valueByName[item1.name.substr(idx + 1)];\r\n                    if (hint != null && hint.length > 0) {\r\n                        widget1.element.attr('title', hint).attr('placeholder', hint);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        protected getLocalizationGridValue(): any {\r\n            var value = {};\r\n            this.localizationGrid.save(value);\r\n\r\n            for (var k of Object.keys(value)) {\r\n                if (k.indexOf('$') < 0) {\r\n                    delete value[k];\r\n                }\r\n            }\r\n\r\n            return value;\r\n        }\r\n\r\n        protected getPendingLocalizations(): any {\r\n            if (this.localizationPendingValue == null) {\r\n                return null;\r\n            }\r\n\r\n            var result: Q.Dictionary<any> = {};\r\n            var idField = this.getIdProperty();\r\n            var langs = this.getLangs();\r\n\r\n            for (var pair of langs) {\r\n                var language = pair[0];\r\n                var entity: any = {};\r\n\r\n                if (idField != null) {\r\n                    entity[idField] = this.get_entityId();\r\n                }\r\n\r\n                var prefix = language + '$';\r\n\r\n                for (var k of Object.keys(this.localizationPendingValue)) {\r\n                    if (Q.startsWith(k, prefix)) \r\n                        entity[k.substr(prefix.length)] = this.localizationPendingValue[k];\r\n                }\r\n\r\n                result[language] = entity;\r\n            }\r\n\r\n            return result;\r\n        }\r\n\r\n        protected initPropertyGrid(): void {\r\n            var pgDiv = this.byId('PropertyGrid');\r\n            if (pgDiv.length <= 0) {\r\n                return;\r\n            }\r\n            var pgOptions = this.getPropertyGridOptions();\r\n            this.propertyGrid = (new Serenity.PropertyGrid(pgDiv, pgOptions)).init(null);\r\n            if (this.element.closest('.ui-dialog').hasClass('s-Flexify')) {\r\n                this.propertyGrid.element.children('.categories').flexHeightOnly(1);\r\n            }\r\n        }\r\n\r\n        protected getPropertyItems() {\r\n            var formKey = this.getFormKey();\r\n            return Q.getForm(formKey);\r\n        }\r\n\r\n        protected getPropertyGridOptions(): PropertyGridOptions {\r\n            return {\r\n                idPrefix: this.idPrefix,\r\n                items: this.getPropertyItems(),\r\n                mode: PropertyGridMode.insert,\r\n                localTextPrefix: 'Forms.' + this.getFormKey() + '.',\r\n                useCategories: true\r\n            };\r\n        }\r\n\r\n        protected validateBeforeSave(): boolean {\r\n            return true;\r\n        }\r\n\r\n        protected getSaveOptions(callback: (response: SaveResponse) => void): ServiceOptions<SaveResponse> {\r\n\r\n            var opt: Q.ServiceOptions<SaveResponse> = {};\r\n\r\n            opt.service = this.getService() + '/' + (this.isEditMode() ? 'Update' : 'Create'),\r\n\r\n            opt.onSuccess = response => {\r\n                this.onSaveSuccess(response);\r\n\r\n                callback && callback(response);\r\n\r\n                var typ = (this.isEditMode() ? 'update' : 'create');\r\n\r\n                var ent = opt.request == null ? null : opt.request.Entity;\r\n                var eid: any = this.isEditMode() ? this.get_entityId() :\r\n                    (response == null ? null : response.EntityId);\r\n\r\n                var dci = {\r\n                    type: typ,\r\n                    entity: ent,\r\n                    entityId: eid\r\n                };\r\n\r\n                this.element.triggerHandler('ondatachange', [dci]);\r\n            };\r\n\r\n            opt.onCleanup = () => {\r\n                this.validator && Q.validatorAbortHandler(this.validator);\r\n            };\r\n\r\n            opt.request = this.getSaveRequest();\r\n\r\n            return opt;\r\n        }\r\n\r\n        protected getSaveEntity(): TItem {\r\n\r\n            var entity: TItem = new Object() as any;\r\n\r\n            if (this.propertyGrid != null) {\r\n                this.propertyGrid.save(entity);\r\n            }\r\n\r\n            if (this.isEditMode()) {\r\n                var idField = this.getIdProperty();\r\n                if (idField != null && entity[idField] == null) {\r\n                    entity[idField] = this.get_entityId();\r\n                }\r\n            }\r\n\r\n            return entity;\r\n        }\r\n\r\n        protected getSaveRequest(): SaveRequest<TItem> {\r\n\r\n            var entity = this.getSaveEntity();\r\n            var req: SaveRequest<TItem> = {};\r\n            req.Entity = entity;\r\n\r\n            if (this.isEditMode()) {\r\n                var idField = this.getIdProperty();\r\n                if (idField != null) {\r\n                    req.EntityId = this.get_entityId();\r\n                }\r\n            }\r\n\r\n            if (this.localizationPendingValue != null) {\r\n                req.Localizations = this.getPendingLocalizations();\r\n            }\r\n\r\n            return req;\r\n        }\r\n\r\n        protected onSaveSuccess(response: SaveResponse): void {\r\n        }\r\n\r\n        protected save_submitHandler(callback: (response: SaveResponse) => void): void {\r\n            var options = this.getSaveOptions(callback);\r\n            this.saveHandler(options, callback);\r\n        }\r\n\r\n        protected save(callback?: (response: SaveResponse) => void): void | boolean {\r\n            return Serenity.ValidationHelper.submit(this.byId('Form'),\r\n                () => this.validateBeforeSave(),\r\n                () => this.save_submitHandler(callback));\r\n        }\r\n\r\n        protected saveHandler(options: ServiceOptions<SaveResponse>,\r\n            callback: (response: SaveResponse) => void): void {\r\n            Q.serviceCall(options);\r\n        }\r\n\r\n        protected initToolbar(): void {\r\n\r\n            super.initToolbar();\r\n\r\n            if (!this.toolbar)\r\n                return;\r\n\r\n            this.saveAndCloseButton = this.toolbar.findButton('save-and-close-button');\r\n            this.applyChangesButton = this.toolbar.findButton('apply-changes-button');\r\n            this.deleteButton = this.toolbar.findButton('delete-button');\r\n            this.undeleteButton = this.toolbar.findButton('undo-delete-button');\r\n            this.editButton = this.toolbar.findButton('edit-button');\r\n            this.cloneButton = this.toolbar.findButton('clone-button');\r\n            this.localizationButton = this.toolbar.findButton('localization-button');\r\n        }\r\n\r\n        protected showSaveSuccessMessage(response: SaveResponse): void {\r\n            Q.notifySuccess(Q.text('Controls.EntityDialog.SaveSuccessMessage'), '', null);\r\n        }\r\n\r\n        protected getToolbarButtons(): ToolButton[] {\r\n            var list: ToolButton[] = [];\r\n\r\n            list.push({\r\n                title: Q.text('Controls.EntityDialog.SaveButton'),\r\n                cssClass: 'save-and-close-button',\r\n                hotkey: 'alt+s',\r\n                onClick: () => {\r\n                    this.save(response => {\r\n                        this.dialogClose();\r\n                    });\r\n                },\r\n                visible: () => !this.isDeleted() && !this.isViewMode(),\r\n                disabled: () => !this.hasSavePermission() || this.readOnly\r\n            });\r\n\r\n            list.push({\r\n                title: '',\r\n                hint: Q.text('Controls.EntityDialog.ApplyChangesButton'),\r\n                cssClass: 'apply-changes-button',\r\n                hotkey: 'alt+a',\r\n                onClick: () => {\r\n                    this.save(response1 => {\r\n\r\n                        if (this.isEditMode()) {\r\n                            var id1 = response1.EntityId;\r\n                            if (id1 == null) {\r\n                                id1 = this.get_entityId();\r\n                            }\r\n                            this.loadById(id1);\r\n                        }\r\n                        else {\r\n                            this.loadById(response1.EntityId);\r\n                        }\r\n\r\n                        this.showSaveSuccessMessage(response1);\r\n                    });\r\n                },\r\n                visible: () => !this.isDeleted() && !this.isViewMode(),\r\n                disabled: () => !this.hasSavePermission() || this.readOnly\r\n            });\r\n\r\n            list.push({\r\n                title: Q.text('Controls.EntityDialog.DeleteButton'),\r\n                cssClass: 'delete-button',\r\n                hotkey: 'alt+x',\r\n                onClick: () => {\r\n                    Q.confirm(Q.text('Controls.EntityDialog.DeleteConfirmation'), () => {\r\n                        this.doDelete(() => this.dialogClose());\r\n                    });\r\n                },\r\n                visible: () => this.isEditMode() && !this.isDeleted() && !this.isViewMode(),\r\n                disabled: () => !this.hasDeletePermission() || this.readOnly\r\n            });\r\n\r\n            list.push({\r\n                title: Q.text('Controls.EntityDialog.UndeleteButton'),\r\n                cssClass: 'undo-delete-button',\r\n                onClick: () => {\r\n                    if (this.isDeleted()) {\r\n                        Q.confirm(Q.text('Controls.EntityDialog.UndeleteConfirmation'), () => {\r\n                            this.undelete(() => this.loadById(this.get_entityId()));\r\n                        });\r\n                    }\r\n                },\r\n                visible: () => this.isEditMode() && this.isDeleted() && !this.isViewMode(),\r\n                disabled: () => !this.hasDeletePermission() || this.readOnly\r\n            });\r\n\r\n            if (this.useViewMode()) {\r\n                list.push({\r\n                    title: Q.text('Controls.EntityDialog.EditButton'),\r\n                    cssClass: 'edit-button',\r\n                    icon: 'fa-edit',\r\n                    onClick: () => {\r\n                        if (!this.isEditMode())\r\n                            return;\r\n\r\n                        this.editClicked = true;\r\n                        this.updateInterface();\r\n                        this.updateTitle();\r\n                    },\r\n                    visible: () => this.isViewMode(),\r\n                    disabled: () => !this.hasSavePermission() || this.readOnly\r\n                });\r\n            }\r\n\r\n            list.push({\r\n                title: Q.text('Controls.EntityDialog.LocalizationButton'),\r\n                cssClass: 'localization-button',\r\n                onClick: () => this.localizationButtonClick()\r\n            });\r\n\r\n            list.push({\r\n                title: Q.text('Controls.EntityDialog.CloneButton'),\r\n                cssClass: 'clone-button',\r\n                onClick: () => {\r\n\r\n                    if (!this.isEditMode()) {\r\n                        return;\r\n                    }\r\n\r\n                    var cloneEntity = this.getCloningEntity();\r\n\r\n                    Serenity.Widget.create({\r\n                        type: Q.getInstanceType(this),\r\n                        init: w => Serenity.SubDialogHelper.bubbleDataChange(\r\n                            Serenity.SubDialogHelper.cascade(w, this.element), this, true)\r\n                            .loadEntityAndOpenDialog(cloneEntity, null)\r\n                    });\r\n                },\r\n                visible: () => false,\r\n                disabled: () => !this.hasInsertPermission() || this.readOnly\r\n            });\r\n\r\n            return list;\r\n        }\r\n\r\n        protected getCloningEntity(): TItem {\r\n\r\n            var clone: TItem = new Object() as any;\r\n            clone = Q.extend(clone, this.get_entity());\r\n\r\n            var idField = this.getIdProperty();\r\n            if (!Q.isEmptyOrNull(idField)) {\r\n                delete clone[idField];\r\n            }\r\n\r\n            var isActiveField = this.getIsActiveProperty();\r\n            if (!Q.isEmptyOrNull(isActiveField)) {\r\n                delete clone[isActiveField];\r\n            }\r\n\r\n            var isDeletedField = this.getIsDeletedProperty();\r\n            if (!Q.isEmptyOrNull(isDeletedField)) {\r\n                delete clone[isDeletedField];\r\n            }\r\n\r\n            return clone;\r\n        }\r\n\r\n        protected updateInterface(): void {\r\n\r\n            Serenity.EditorUtils.setContainerReadOnly(this.byId('Form'), false);\r\n\r\n            var isDeleted = this.isDeleted();\r\n            var isLocalizationMode = this.isLocalizationMode();\r\n            var hasSavePermission = this.hasSavePermission();\r\n            var viewMode = this.isViewMode();\r\n            var isDeleted = this.isDeleted();\r\n            var readOnly = this.readOnly;\r\n\r\n            this.toolbar.updateInterface();\r\n\r\n            if (this.tabs != null) {\r\n                Serenity.TabsExtensions.setDisabled(this.tabs, 'Log', this.isNewOrDeleted());\r\n            }\r\n\r\n            if (this.propertyGrid != null) {\r\n                this.propertyGrid.element.toggle(!isLocalizationMode);\r\n            }\r\n\r\n            if (this.localizationGrid != null) {\r\n                this.localizationGrid.element.toggle(isLocalizationMode);\r\n            }\r\n\r\n            if (this.localizationButton != null) {\r\n                this.localizationButton.toggle(this.localizationGrid != null);\r\n                this.localizationButton.find('.button-inner')\r\n                    .text((this.isLocalizationMode() ?\r\n                        Q.text('Controls.EntityDialog.LocalizationBack') :\r\n                        Q.text('Controls.EntityDialog.LocalizationButton')));\r\n            }\r\n\r\n            if (isLocalizationMode) {\r\n\r\n                if (this.toolbar != null)\r\n                    this.toolbar.findButton('tool-button')\r\n                        .not('.localization-hidden')\r\n                        .addClass('.localization-hidden').hide();\r\n\r\n                this.localizationButton && this.localizationButton.show();\r\n\r\n                return;\r\n            }\r\n\r\n            this.toolbar.findButton('localization-hidden')\r\n                .removeClass('localization-hidden').show();\r\n\r\n            this.saveAndCloseButton && this.saveAndCloseButton\r\n                    .find('.button-inner').text(Q.text((this.isNew() ? 'Controls.EntityDialog.SaveButton' :\r\n                        'Controls.EntityDialog.UpdateButton')));\r\n\r\n            if (!hasSavePermission || viewMode || readOnly)\r\n                Serenity.EditorUtils.setContainerReadOnly(this.byId(\"Form\"), true);\r\n        }\r\n\r\n        protected getUndeleteOptions(callback?: (response: UndeleteResponse) => void): ServiceOptions<UndeleteResponse> {\r\n            return {}\r\n        }\r\n\r\n        protected undeleteHandler(options: ServiceOptions<UndeleteResponse>, callback: (response: UndeleteResponse) => void): void {\r\n            Q.serviceCall(options);\r\n        }\r\n\r\n        protected undelete(callback?: (response: UndeleteResponse) => void): void {\r\n            var baseOptions: Q.ServiceOptions<UndeleteResponse> = {};\r\n            baseOptions.service = this.getService() + '/Undelete';\r\n\r\n            var request: UndeleteRequest = {};\r\n            request.EntityId = this.get_entityId();\r\n\r\n            baseOptions.request = request;\r\n            baseOptions.onSuccess = response => {\r\n                callback && callback(response);\r\n                this.element.triggerHandler('ondatachange', [{\r\n                    entityId: this.get_entityId(),\r\n                    entity: this.entity,\r\n                    type: 'undelete'\r\n                }]);\r\n            };\r\n\r\n            var thisOptions = this.getUndeleteOptions(callback);\r\n            var finalOptions = Q.extend(baseOptions, thisOptions);\r\n            this.undeleteHandler(finalOptions, callback);\r\n        }\r\n\r\n        private _readonly: boolean;\r\n\r\n        public get readOnly(): boolean {\r\n            return this.get_readOnly();\r\n        }\r\n\r\n        public set readOnly(value: boolean) {\r\n            this.set_readOnly(value);\r\n        }\r\n\r\n        public get_readOnly() {\r\n            return !!this._readonly;\r\n        }\r\n\r\n        public set_readOnly(value: boolean) {\r\n            if (!!this._readonly != !!value) {\r\n                this._readonly = !!value;\r\n                this.updateInterface();\r\n                this.updateTitle();\r\n            }\r\n        }\r\n\r\n        protected getInsertPermission(): string {\r\n            return null;\r\n        }\r\n\r\n        protected getUpdatePermission(): string {\r\n            return null;\r\n        }\r\n\r\n        protected getDeletePermission(): string {\r\n            return null;\r\n        }\r\n\r\n        protected hasDeletePermission() {\r\n            var deletePermission = this.getDeletePermission();\r\n            return deletePermission == null || Q.Authorization.hasPermission(deletePermission);\r\n        }\r\n\r\n        protected hasInsertPermission() {\r\n            var insertPermission = this.getInsertPermission();\r\n            return insertPermission == null || Q.Authorization.hasPermission(insertPermission);\r\n        }\r\n\r\n        protected hasUpdatePermission() {\r\n            var updatePermission = this.getUpdatePermission();\r\n            return updatePermission == null || Q.Authorization.hasPermission(updatePermission);\r\n        }\r\n\r\n        protected hasSavePermission(): boolean {\r\n            return this.isNew() ? this.hasInsertPermission() : this.hasUpdatePermission();\r\n        }\r\n\r\n        protected editClicked: boolean;\r\n\r\n        protected isViewMode() {\r\n            return this.useViewMode() && this.isEditMode() && !this.editClicked;\r\n        }\r\n\r\n        protected useViewMode() {\r\n            return false;\r\n        }\r\n    }\r\n}"]}