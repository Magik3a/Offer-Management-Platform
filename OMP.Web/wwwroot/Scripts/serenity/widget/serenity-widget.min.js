var Serenity;(function(e){var t;(function(e){function t(e){return e.filter(function(t,n){return e.indexOf(t)===n})}function n(e,n){if(!e||!n)return(e||n||[]).slice();return t(e.concat(n))}function r(e,t,r){if(t!=null){e.__typeName=t;Q.types[t]=e}else if(!e.__typeName)e.__register=true;else Q.types[e.__typeName]=e;if(r)e.__interfaces=n(e.__interfaces,r)}function i(e,t){return function(n){if(typeof e=="string")r(n,e,t);else r(n,null,e);n.__class=true}}e.registerClass=i;function a(e,t){return function(n){if(typeof e=="string")r(n,e,t);else r(n,null,e);n.__interface=true;n.isAssignableFrom=function(e){return e.__interfaces!=null&&e.__interfaces.indexOf(this)>=0}}}e.registerInterface=a;function o(e,t){return i(e,t)}e.registerEditor=o;function u(e,t){e.__metadata=e.__metadata||{};e.__metadata.attr=e.__metadata.attr||[];e.__metadata.attr.push(t)}e.addAttribute=u})(t=e.Decorators||(e.Decorators={}));e.Decorators.registerInterface("Serenity.ISlickFormatter")(e.ISlickFormatter);var n=function(){function t(e){this.value=e}t=__decorate([e.Decorators.registerClass("Serenity.EnumKeyAttribute")],t);return t}();e.EnumKeyAttribute=n;(function(e){function t(t){return function(r){e.addAttribute(r,new n(t))}}e.enumKey=t;function r(t,r,i){if(!t.__enum){Object.defineProperty(t,"__enum",{get:function(){return true}});t.prototype=t.prototype||{};for(var a=0,o=Object.keys(t);a<o.length;a++){var u=o[a];if(isNaN(Q.parseInteger(u))&&t[u]!=null&&!isNaN(Q.parseInteger(t[u])))t.prototype[u]=t[u]}if(i!=null){t.__typeName=i;Q.types[i]=t}else if(!t.__typeName)t.__register=true;if(r)e.addAttribute(t,new n(r))}}e.registerEnum=r;function i(e,t,n){r(e,Q.coalesce(n,t),t)}e.registerEnumType=i})(t=e.Decorators||(e.Decorators={}));e.Decorators.registerEnum(e.SummaryType,"Serenity.SummaryType")})(Serenity||(Serenity={}));var System;(function(e){var t;(function(e){var t=function(){function e(e){this.displayName=e}e=__decorate([Serenity.Decorators.registerClass("System.DisplayNameAttribute")],e);return e}();e.DisplayNameAttribute=t})(t=e.ComponentModel||(e.ComponentModel={}))})(System||(System={}));(function(e){function t(t){return e.Decorators.registerClass("Serenity."+t+"Attribute")}var n=function(){function e(e){this.category=e}e=__decorate([t("Category")],e);return e}();e.CategoryAttribute=n;var r=function(){function e(e){this.value=e}e=__decorate([t("ColumnsKey")],e);return e}();e.ColumnsKeyAttribute=r;var i=function(){function e(e){this.cssClass=e}e=__decorate([t("CssClass")],e);return e}();e.CssClassAttribute=i;var a=function(){function e(e){this.value=e}e=__decorate([t("DefaultValue")],e);return e}();e.DefaultValueAttribute=a;var o=function(){function e(e){this.value=e}e=__decorate([t("DialogType")],e);return e}();e.DialogTypeAttribute=o;var u=function(){function e(){}e=__decorate([t("Editor")],e);return e}();e.EditorAttribute=u;var l=function(){function e(e,t){this.key=e;this.value=t}e=__decorate([t("EditorOption")],e);return e}();e.EditorOptionAttribute=l;var s=function(){function t(e){this.editorType=e}t.prototype.setParams=function(e){};t=__decorate([e.Decorators.registerClass("Serenity.EditorTypeAttributeBase")],t);return t}();e.EditorTypeAttributeBase=s;var f=function(e){__extends(n,e);function n(t){return e.call(this,t)||this}n=__decorate([t("EditorType")],n);return n}(s);e.EditorTypeAttribute=f;var c=function(){function e(e){this.value=e}e=__decorate([t("Element")],e);return e}();e.ElementAttribute=c;var d=function(){function e(e){this.value=e}e=__decorate([t("EntityType")],e);return e}();e.EntityTypeAttribute=d;var p=function(){function e(e){if(e===void 0){e=true}this.value=e}e=__decorate([t("Filterable")],e);return e}();e.FilterableAttribute=p;var m=function(){function e(e){this.value=e}e=__decorate([t("FormKey")],e);return e}();e.FormKeyAttribute=m;var y=function(){function e(e){this.origin=e}e=__decorate([t("GeneratedCode")],e);return e}();e.GeneratedCodeAttribute=y;var g=function(){function e(){}e=__decorate([t("Hidden")],e);return e}();e.HiddenAttribute=g;var v=function(){function e(e){this.hint=e}e=__decorate([t("Hint")],e);return e}();e.HintAttribute=v;var h=function(){function e(e){this.value=e}e=__decorate([t("IdProperty")],e);return e}();e.IdPropertyAttribute=h;var b=function(){function e(e){if(e===void 0){e=true}this.value=e}e=__decorate([t("Insertable")],e);return e}();e.InsertableAttribute=b;var _=function(){function e(e){this.value=e}e=__decorate([t("IsActiveProperty")],e);return e}();e.IsActivePropertyAttribute=_;var S=function(){function e(e){this.value=e}e=__decorate([t("ItemName")],e);return e}();e.ItemNameAttribute=S;var C=function(){function e(e){this.value=e}e=__decorate([t("LocalTextPrefix")],e);return e}();e.LocalTextPrefixAttribute=C;var T=function(){function e(e){if(e===void 0){e=true}this.value=e}e=__decorate([t("Maximizable")],e);return e}();e.MaximizableAttribute=T;var w=function(){function e(e){this.maxLength=e}e=__decorate([t("MaxLength")],e);return e}();e.MaxLengthAttribute=w;var I=function(){function e(e){this.value=e}e=__decorate([t("NameProperty")],e);return e}();e.NamePropertyAttribute=I;var N=function(){function e(){}e=__decorate([t("OneWay")],e);return e}();e.OneWayAttribute=N;var D=function(){function e(){}e=__decorate([t("Option")],e);return e}();e.OptionAttribute=D;var x=function(){function e(e){this.value=e}e=__decorate([t("OptionsType")],e);return e}();e.OptionsTypeAttribute=x;var A=function(){function e(e){if(e===void 0){e=true}this.value=e}e=__decorate([t("Panel")],e);return e}();e.PanelAttribute=A;var E=function(){function e(e){this.value=e}e=__decorate([t("Placeholder")],e);return e}();e.PlaceholderAttribute=E;var W=function(){function e(e){if(e===void 0){e=true}this.value=e}e=__decorate([t("ReadOnly")],e);return e}();e.ReadOnlyAttribute=W;var $=function(){function e(e){if(e===void 0){e=true}this.isRequired=e}e=__decorate([t("Required")],e);return e}();e.RequiredAttribute=$;var O=function(){function e(e){if(e===void 0){e=true}this.value=e}e=__decorate([t("Resizable")],e);return e}();e.ResizableAttribute=O;var k=function(){function e(e){if(e===void 0){e=true}this.value=e}e=__decorate([t("Responsive")],e);return e}();e.ResponsiveAttribute=k;var R=function(){function e(e){this.value=e}e=__decorate([t("Service")],e);return e}();e.ServiceAttribute=R;var F=function(){function e(e){if(e===void 0){e=true}this.value=e}e=__decorate([t("Updatable")],e);return e}();e.UpdatableAttribute=F;var P;(function(t){function n(){return function(t,n){var r=Q.startsWith(n,"get_")||Q.startsWith(n,"set_");var i=r?n.substr(4):n;var a=t.constructor;a.__metadata=a.__metadata||{};a.__metadata.members=a.__metadata.members||[];var o=undefined;for(var u=0,l=a.__metadata.members;u<l.length;u++){var s=l[u];if(s.name==i){o=s;break}}if(!o){o={attr:[new e.OptionAttribute],name:i};if(r){o.type=16;o.getter={name:"get_"+i};o.setter={name:"set_"+i}}else{o.type=4}a.__metadata.members.push(o)}else{o.attr=o.attr||[];o.attr.push(new D)}}}t.option=n;function r(n,r){if(n===void 0){n=[e.ISlickFormatter]}if(r===void 0){r=[e.ISlickFormatter]}return t.registerClass(n,r)}t.registerFormatter=r;function i(e){return function(n){t.addAttribute(n,new o(e))}}t.dialogType=i;function a(e){return function(n){var r=new u;if(e!==undefined)r.key=e;t.addAttribute(n,r)}}t.editor=a;function l(e){return function(n){t.addAttribute(n,new c(e))}}t.element=l;function s(e){if(e===void 0){e=true}return function(n){t.addAttribute(n,new p(e))}}t.filterable=s;function f(e){return function(n){t.addAttribute(n,new S(e))}}t.itemName=f;function d(e){if(e===void 0){e=true}return function(n){t.addAttribute(n,new T(e))}}t.maximizable=d;function m(e){return function(n){t.addAttribute(n,new x(e))}}t.optionsType=m;function y(e){if(e===void 0){e=true}return function(n){t.addAttribute(n,new A(e))}}t.panel=y;function g(e){if(e===void 0){e=true}return function(n){t.addAttribute(n,new O(e))}}t.resizable=g;function v(e){if(e===void 0){e=true}return function(n){t.addAttribute(n,new k(e))}}t.responsive=v;function h(e){return function(n){t.addAttribute(n,new R(e))}}t.service=h})(P=e.Decorators||(e.Decorators={}))})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface("Serenity.IDialog")],t);return t}();e.IDialog=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface("Serenity.IEditDialog")],t);return t}();e.IEditDialog=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface()],t);return t}();e.IBooleanValue=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface()],t);return t}();e.IDoubleValue=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface()],t);return t}();e.IStringValue=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface()],t);return t}();e.IGetEditValue=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface()],t);return t}();e.ISetEditValue=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface("Serenity.IReadOnly")],t);return t}();e.IReadOnly=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface("Serenity.IValidateRequired")],t);return t}();e.IValidateRequired=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t;(function(t){function n(t){var n=Q.getType(t);if(n!=null&&Q.isAssignableFrom(e.IDialog,n)){return n}for(var r=0,i=Q.Config.rootNamespaces;r<i.length;r++){var a=i[r];n=Q.getType(a+"."+t);if(n!=null&&Q.isAssignableFrom(e.IDialog,n)){return n}}return null}var r={};function i(e){if(r[e]==null){var t=e;var i=n(t);if(i==null&&!Q.endsWith(e,"Dialog")){t=e+"Dialog";i=n(t)}if(i==null){return null}r[e]=i;return i}return r[e]}t.tryGet=i;function a(e){var t=i(e);if(t==null){var n=e+" dialog class is not found! Make sure there is a dialog class with this name, "+"it is under your project root namespace, and your namespace parts start with capital letters, "+"e.g. MyProject.Pascal.Cased namespace. If you got this error from an editor with InplaceAdd option "+"check that lookup key and dialog type name matches (case sensitive, excluding Dialog suffix). "+"You need to change lookup key or specify DialogType property in LookupEditor attribute if that's not the case.";Q.notifyError(n,"",null);throw new Q.Exception(n)}return t}t.get=a})(t=e.DialogTypeRegistry||(e.DialogTypeRegistry={}))})(Serenity||(Serenity={}));var Serenity;(function(e){var t;(function(t){var n;function r(e){var t;if(Q.isEmptyOrNull(e)){throw new Q.ArgumentNullException("key")}i();var r=n[e.toLowerCase()];if(r==null){var a=(t=Q.getType(e))!==null&&t!==void 0?t:Q.getType(e,globalObj);if(a!=null){n[e.toLowerCase()]=a;return a}throw new Q.Exception(Q.format("Can't find {0} editor type!",e))}return r}t.get=r;function i(){if(n!=null)return;n={};for(var t=0,r=Q.getTypes();t<r.length;t++){var i=r[t];var a=Q.getTypeFullName(i).toLowerCase();n[a]=i;var u=Q.getAttributes(i,e.EditorAttribute,false);if(u!=null&&u.length>0){var l=u[0].key;if(!Q.isEmptyOrNull(l)){n[l.toLowerCase()]=i}}for(var s=0,f=Q.Config.rootNamespaces;s<f.length;s++){var c=f[s];if(Q.startsWith(a,c.toLowerCase()+".")){var d=a.substr(c.length+1).toLowerCase();if(n[d]==null){n[d]=i}}}}o()}function a(){n=null}t.reset=a;function o(){var e="editor";var t=Object.keys(n);for(var r=0,i=t;r<i.length;r++){var a=i[r];u(a,n[a])}}function u(e,t){var r="editor";if(!Q.endsWith(e,r))return;var i=e.substr(0,e.length-r.length);if(Q.isEmptyOrNull(i))return;if(n[i]!=null)return;n[i]=n[e]}})(t=e.EditorTypeRegistry||(e.EditorTypeRegistry={}))})(Serenity||(Serenity={}));var Serenity;(function(e){var t;(function(t){var n;function r(t){if(n==null){n={};for(var r=0,i=Q.getTypes();r<i.length;r++){var a=i[r];if(Q.isEnum(a)){var o=Q.getTypeFullName(a);n[o]=a;var u=Q.getAttributes(a,e.EnumKeyAttribute,false);if(u!=null&&u.length>0){n[u[0].value]=a}for(var l=0,s=Q.Config.rootNamespaces;l<s.length;l++){var f=s[l];if(Q.startsWith(o,f+".")){n[o.substr(f.length+1)]=a}}}}}if(n[t]==null)return null;return n[t]}t.tryGet=r;function i(e){var n=t.tryGet(e);if(n==null){var r=Q.format("Can't find {0} enum type! If you have recently defined this enum type "+"in server side code, make sure your project builds successfully and transform T4 templates. "+"Also make sure that enum is under your project root namespace, and your namespace parts starts "+"with capital letters, e.g.MyProject.Pascal.Cased namespace",e);Q.notifyError(r,"",null);throw new Q.Exception(r)}return n}t.get=i})(t=e.EnumTypeRegistry||(e.EnumTypeRegistry={}))})(Serenity||(Serenity={}));var Serenity;(function(e){var t;(function(e){function t(e,t){var n=e;var i=n["get_"+t];if(!!!(typeof i==="undefined")){return i.apply(e)}var a=r(t);i=n["get_"+a];if(!!!(typeof i==="undefined")){return i.apply(e)}return n[a]}e.getPropertyValue=t;function n(e,t,n){var i=e;var a=i["set_"+t];if(!!!(typeof a==="undefined")){a.apply(e,[n]);return}var o=r(t);a=i["set_"+o];if(!!!(typeof a==="undefined")){a.apply(e,[n]);return}i[o]=n}e.setPropertyValue=n;function r(e){if(Q.isEmptyOrNull(e)){return e}if(e==="ID"){return"id"}var t=false;var n=0;for(var r=0;r<e.length;r++){if(e.charCodeAt(r)>=65&&e.charCodeAt(r)<=90){n++}else{t=true;break}}if(!t&&e.length!==1||n===0){return e}else if(n>1){return e.substr(0,n-1).toLowerCase()+e.substr(n-1)}else if(e.length===1){return e.toLowerCase()}else{return e.substr(0,1).toLowerCase()+e.substr(1)}}e.makeCamelCase=r})(t=e.ReflectionUtils||(e.ReflectionUtils={}))})(Serenity||(Serenity={}));var Serenity;(function(e){if(typeof React==="undefined"&&typeof window!=="undefined"){if(window["preact"]!=null){window["React"]=window["ReactDOM"]=window["preact"];React.Fragment=Q.coalesce(React.Fragment,"x-fragment")}else if(window["Nerv"]!=null){window["React"]=window["ReactDOM"]=window["Nerv"];React.Fragment=Q.coalesce(React.Fragment,"x-fragment")}else{window["React"]={Component:function(){},Fragment:"x-fragment",createElement:function(){return{_reactNotLoaded:true}}};window["ReactDOM"]={render:function(){throw Error("To use React, it should be included before Serenity.CoreLib.js")}}}}var t=function(t){__extends(n,t);function n(e,n){var i=t.call(this,n)||this;i.element=e;i.options=n||{};i.widgetName=r.getWidgetName(Q.getInstanceType(i));i.uniqueName=i.widgetName+(r.nextWidgetNumber++).toString();if(e.data(i.widgetName)){throw new Q.Exception(Q.format("The element already has widget '{0}'!",i.widgetName))}e.on("remove."+i.widgetName,function(e){if(e.bubbles||e.cancelable){return}i.destroy()}).data(i.widgetName,i);i.addCssClass();return i}r=n;n.prototype.destroy=function(){if(this.element){this.element.removeClass("s-"+Q.getTypeName(Q.getInstanceType(this)));this.element.off("."+this.widgetName).off("."+this.uniqueName).removeData(this.widgetName);this.element=null}};n.prototype.addCssClass=function(){this.element.addClass(this.getCssClass())};n.prototype.getCssClass=function(){var e=Q.getInstanceType(this);var t="s-"+Q.getTypeName(e);var n=Q.replaceAll(Q.getTypeFullName(e),".","-");for(var r=0,i=Q.Config.rootNamespaces;r<i.length;r++){var a=i[r];if(Q.startsWith(n,a+"-")){n=n.substr(a.length+1);break}}n="s-"+n;if(t===n){return t}return t+" "+n};n.getWidgetName=function(e){return Q.replaceAll(Q.getTypeFullName(e),".","_")};n.elementFor=function(t){var n=Q.getAttributes(t,e.ElementAttribute,true);var r=n.length>0?n[0].value:"<input/>";return $(r)};n.prototype.addValidationRule=function(e,t){return Q.addValidationRule(this.element,e,t)};n.prototype.getGridField=function(){return this.element.closest(".field")};n.prototype.change=function(e){this.element.on("change."+this.uniqueName,e)};n.prototype.changeSelect2=function(e){this.element.on("change."+this.uniqueName,function(t){if(!$(t.target).hasClass("select2-change-triggered"))e(t)})};n.create=function(t){var n;if(Q.isAssignableFrom(e.IDialog,t.type)){n=new t.type(t.options);if(t.container)n.element.appendTo(t.container);t.element&&t.element(n.element)}else{var i=r.elementFor(t.type);if(t.container)i.appendTo(t.container);t.element&&t.element(i);n=new t.type(i,t.options)}n.init(null);t.init&&t.init(n);return n};n.prototype.initialize=function(){};n.prototype.init=function(e){e&&e(this);return this};var r;n.nextWidgetNumber=0;n.__isWidgetType=true;n=r=__decorate([e.Decorators.registerClass()],n);return n}(React.Component);e.Widget=t;if(typeof $!=="undefined"&&$.fn){$.fn.tryGetWidget=function(n){var r=this;var i;if(Q.isAssignableFrom(e.Widget,n)){var a=t.getWidgetName(n);i=r.data(a);if(i!=null&&!Q.isAssignableFrom(n,Q.getInstanceType(i))){i=null}if(i!=null){return i}}var o=r.data();if(o==null){return null}for(var u=0,l=Object.keys(o);u<l.length;u++){var s=l[u];i=o[s];if(i!=null&&Q.isAssignableFrom(n,Q.getInstanceType(i))){return i}}return null};$.fn.getWidget=function(e){if(this==null){throw new Q.ArgumentNullException("element")}if(this.length===0){throw new Q.Exception(Q.format("Searching for widget of type '{0}' on a non-existent element! ({1})",Q.getTypeFullName(e),this.selector))}var t=this.tryGetWidget(e);if(t==null){var n=Q.format("Element has no widget of type '{0}'! If you have recently changed "+"editor type of a property in a form class, or changed data type in row (which also changes "+"editor type) your script side Form definition might be out of date. Make sure your project "+"builds successfully and transform T4 templates",Q.getTypeFullName(e));Q.notifyError(n,"",null);throw new Q.Exception(n)}return t}}})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(n,t);function n(e,n){var r=t.call(this,e,n)||this;r.idPrefix=r.uniqueName+"_";var i=r.getTemplate().replace(new RegExp("~_","g"),r.idPrefix);var a=0;while(true){var o=i.indexOf('{{text:"',a);if(o<0)break;var a=i.indexOf('"}}',o);if(a<0)break;var u=i.substr(o+8,a-o-8);var l=Q.text(u);i=i.substr(0,o)+l+i.substr(a+3);a=o+l.length}r.element.html(i);return r}r=n;n.prototype.byId=function(e){return $("#"+this.idPrefix+e)};n.prototype.byID=function(e,t){return this.byId(e).getWidget(t)};n.noGeneric=function(e){var t=e.indexOf("$");if(t>=0){return e.substr(0,t)}return e};n.prototype.getDefaultTemplateName=function(){return r.noGeneric(Q.getTypeName(Q.getInstanceType(this)))};n.prototype.getTemplateName=function(){var t=Q.getInstanceType(this);var n=Q.getTypeFullName(t);var i=r.templateNames;var a=r.templateNames[n];if(a!=null){return a}while(t&&t!==e.Widget){var o=r.noGeneric(Q.getTypeFullName(t));for(var u=0,l=Q.Config.rootNamespaces;u<l.length;u++){var s=l[u];if(Q.startsWith(o,s+".")){o=o.substr(s.length+1);break}}if(Q.canLoadScriptData("Template."+o)){i[n]=o;return o}o=Q.replaceAll(o,".","_");if(Q.canLoadScriptData("Template."+o)||$("script#Template_"+o).length>0){i[n]=o;return o}o=r.noGeneric(Q.getTypeName(t));if(Q.canLoadScriptData("Template."+o)||$("script#Template_"+o).length>0){r.templateNames[n]=o;return o}t=Q.getBaseType(t)}i[n]=a=this.getDefaultTemplateName();return a};n.prototype.getFallbackTemplate=function(){return null};n.prototype.getTemplate=function(){var e=this.getTemplateName();var t=$("script#Template_"+e);if(t.length>0){return t.html()}var n;if(!Q.canLoadScriptData("Template."+e)&&this.getDefaultTemplateName()==e){n=this.getFallbackTemplate();if(n!=null)return n}n=Q.getTemplate(e);if(n==null){throw new Error(Q.format("Can't locate template for widget '{0}' with name '{1}'!",Q.getTypeName(Q.getInstanceType(this)),e))}return n};var r;n.templateNames={};n=r=__decorate([e.Decorators.registerClass()],n);return n}(e.Widget);e.TemplatedWidget=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(e,t,n){var r=this;this.parentType=e;this.widget=t;this.parentChange=n;this.bind();this.widget.element.bind("remove."+t.uniqueName+"cwh",function(e){r.unbind();r.widget=null;r.parentChange=null})}t.prototype.bind=function(){var e=this;if(Q.isEmptyOrNull(this._parentID)){return null}var t=Q.findElementWithRelativeId(this.widget.element,this._parentID).tryGetWidget(this.parentType);if(t!=null){t.element.bind("change."+this.widget.uniqueName,function(){e.parentChange(t)});return t}else{Q.notifyError("Can't find cascaded parent element with ID: "+this._parentID+"!","",null);return null}};t.prototype.unbind=function(){if(Q.isEmptyOrNull(this._parentID)){return null}var e=Q.findElementWithRelativeId(this.widget.element,this._parentID).tryGetWidget(this.parentType);if(e!=null){e.element.unbind("."+this.widget.uniqueName)}return e};t.prototype.get_parentID=function(){return this._parentID};t.prototype.set_parentID=function(e){if(this._parentID!==e){this.unbind();this._parentID=e;this.bind()}};t=__decorate([e.Decorators.registerClass("Serenity.CascadedWidgetLink")],t);return t}();e.CascadedWidgetLink=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t;(function(e){function t(e){e.container.addClass("fileinput-button");var t=$("<input/>").attr("type","file").attr("name",e.inputName+"[]").attr("data-url",Q.resolveUrl("~/File/TemporaryUpload")).attr("multiple","multiple").appendTo(e.container);if(e.allowMultiple){t.attr("multiple","multiple")}t.fileupload({dataType:"json",dropZone:e.zone,pasteZone:e.zone,done:function(t,n){var r=n.result;if(e.fileDone!=null){e.fileDone(r,n.files[0].name,n)}},start:function(){Q.blockUI(null);if(e.progress!=null){e.progress.show()}},stop:function(){Q.blockUndo();if(e.progress!=null){e.progress.hide()}},progress:function(t,n){if(e.progress!=null){var r=n.loaded/n.total*100;e.progress.children().css("width",r.toString()+"%")}}});return t}e.addUploadInput=t;function n(t,n){if(!t.IsImage&&!n.allowNonImage){Q.alert(Q.text("Controls.ImageUpload.NotAnImageFile"));return false}if(n.minSize>0&&t.Size<n.minSize){Q.alert(Q.format(Q.text("Controls.ImageUpload.UploadFileTooSmall"),e.fileSizeDisplay(n.minSize)));return false}if(n.maxSize>0&&t.Size>n.maxSize){Q.alert(Q.format(Q.text("Controls.ImageUpload.UploadFileTooBig"),e.fileSizeDisplay(n.maxSize)));return false}if(!t.IsImage){return true}if(n.minWidth>0&&t.Width<n.minWidth){Q.alert(Q.format(Q.text("Controls.ImageUpload.MinWidth"),n.minWidth));return false}if(n.maxWidth>0&&t.Width>n.maxWidth){Q.alert(Q.format(Q.text("Controls.ImageUpload.MaxWidth"),n.maxWidth));return false}if(n.minHeight>0&&t.Height<n.minHeight){Q.alert(Q.format(Q.text("Controls.ImageUpload.MinHeight"),n.minHeight));return false}if(n.maxHeight>0&&t.Height>n.maxHeight){Q.alert(Q.format(Q.text("Controls.ImageUpload.MaxHeight"),n.maxHeight));return false}return true}e.checkImageConstraints=n;function r(e,t){return e+" ("+i(t)+")"}e.fileNameSizeDisplay=r;function i(e){var t=Q.round(e*100/1024)*.01;var n="KB";if(t>=1024){t=Q.round(t*100/1024)*.01;n="MB"}var r=t.toString().split(String.fromCharCode(46));var i;if(r.length>1){i=r[0]+"."+r[1].substr(0,2)}else{i=r[0]}return i+" "+n}e.fileSizeDisplay=i;function a(e){if(Q.isEmptyOrNull(e)){return false}e=e.toLowerCase();return Q.endsWith(e,".jpg")||Q.endsWith(e,".jpeg")||Q.endsWith(e,".gif")||Q.endsWith(e,".png")}e.hasImageExtension=a;function o(e){e=Q.coalesce(e,"");var t=e.lastIndexOf(".");if(t>=0){e=e.substr(0,t)}return e+"_t.jpg"}e.thumbFileName=o;function u(e){e=Q.replaceAll(Q.coalesce(e,""),"\\","/");return Q.resolveUrl("~/upload/")+e}e.dbFileUrl=u;function l(e,t){e.colorbox({current:Q.text("Controls.ImageUpload.ColorboxCurrent"),previous:Q.text("Controls.ImageUpload.ColorboxPrior"),next:Q.text("Controls.ImageUpload.ColorboxNext"),close:Q.text("Controls.ImageUpload.ColorboxClose")})}e.colorBox=l;function s(e,t,n,r){t=t||[];e.html("");for(var i=0;i<t.length;i++){var s=t[i];var f=$("<li/>").addClass("file-item").data("index",i);var c=a(s.Filename);if(c){f.addClass("file-image")}else{f.addClass("file-binary")}var d="#"+i;var p=$("<a/>").addClass("thumb").appendTo(f);var m=Q.coalesce(s.OriginalName,"");var y=s.Filename;if(r!=null&&y!=null&&!Q.startsWith(y,"temporary/")){y=r+y}p.attr("href",u(y));p.attr("target","_blank");if(!Q.isEmptyOrNull(m)){p.attr("title",m)}if(c){p.css("backgroundImage","url('"+u(o(s.Filename))+"')");l(p,new Object)}if(n){$("<div/>").addClass("filename").text(m).attr("title",m).appendTo(f)}f.appendTo(e)}}e.populateFileSymbols=s})(t=e.UploadHelper||(e.UploadHelper={}))})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(n,t);function n(e,n){var r=t.call(this,e,n)||this;e.addClass("s-PopupMenuButton");e.click(function(e){e.preventDefault();e.stopPropagation();if(r.options.onPopup!=null){r.options.onPopup()}var t=r.options.menu;t.show().position({my:Q.coalesce(r.options.positionMy,"left top"),at:Q.coalesce(r.options.positionAt,"left bottom"),of:r.element});var n=r.uniqueName;$(document).one("click."+n,function(e){t.hide()})});r.options.menu.hide().appendTo(document.body).addClass("s-PopupMenu").menu();return r}n.prototype.destroy=function(){if(this.options.menu!=null){this.options.menu.remove();this.options.menu=null}t.prototype.destroy.call(this)};n=__decorate([e.Decorators.registerEditor("Serenity.PopupMenuButton")],n);return n}(e.Widget);e.PopupMenuButton=t;var n=function(t){__extends(n,t);function n(e,n){var r=t.call(this,e,n)||this;e.addClass("s-PopupToolButton");$("<b/>").appendTo(e.children(".button-outer").children("span"));return r}n=__decorate([e.Decorators.registerEditor("Serenity.PopupToolButton")],n);return n}(t);e.PopupToolButton=n;var r=function(t){__extends(n,t);function n(e,n){var r=t.call(this,e,n)||this;r.element.addClass("s-Toolbar clearfix").html('<div class="tool-buttons"><div class="buttons-outer">'+'<div class="buttons-inner"></div></div></div>');var i=$("div.buttons-inner",r.element);var a=r.options.buttons;for(var o=0;o<a.length;o++){r.createButton(i,a[o])}return r}n.prototype.destroy=function(){this.element.find("div.tool-button").unbind("click");if(this.mouseTrap){if(!!this.mouseTrap.destroy){this.mouseTrap.destroy()}else{this.mouseTrap.reset()}this.mouseTrap=null}t.prototype.destroy.call(this)};n.prototype.createButton=function(e,t){var n=Q.coalesce(t.cssClass,"");if(t.separator===true||t.separator==="left"||t.separator==="both"){$('<div class="separator"></div>').appendTo(e)}var r=$('<div class="tool-button"><div class="button-outer">'+'<span class="button-inner"></span></div></div>').appendTo(e);if(t.separator==="right"||t.separator==="both"){$('<div class="separator"></div>').appendTo(e)}if(n.length>0){r.addClass(n)}if(!Q.isEmptyOrNull(t.hint)){r.attr("title",t.hint)}r.click(function(e){if(r.hasClass("disabled")){return}t.onClick(e)});var i=t.title;if(t.htmlEncode!==false){i=Q.htmlEncode(t.title)}if(!Q.isEmptyOrNull(t.icon)){r.addClass("icon-tool-button");var a=t.icon;if(Q.startsWith(a,"fa-")){a="fa "+a}else if(Q.startsWith(a,"glyphicon-")){a="glyphicon "+a}i="<i class='"+a+"'></i> "+i}if(i==null||i.length===0){r.addClass("no-text")}else{r.find("span").html(i)}if(t.visible===false)r.hide();if(t.disabled!=null&&typeof t.disabled!=="function")r.toggleClass("disabled",!!t.disabled);if(typeof t.visible==="function"||typeof t.disabled=="function"){r.on("updateInterface",function(){if(typeof t.visible==="function")r.toggle(!!t.visible());if(typeof t.disabled==="function")r.toggleClass("disabled",!!t.disabled())})}if(!!(!Q.isEmptyOrNull(t.hotkey)&&window["Mousetrap"]!=null)){this.mouseTrap=this.mouseTrap||window["Mousetrap"](t.hotkeyContext||this.options.hotkeyContext||window.document.documentElement);this.mouseTrap.bind(t.hotkey,function(e,n){if(r.is(":visible")){r.triggerHandler("click")}return t.hotkeyAllowDefault})}};n.prototype.findButton=function(e){if(e!=null&&Q.startsWith(e,".")){e=e.substr(1)}return $("div.tool-button."+e,this.element)};n.prototype.updateInterface=function(){this.element.find(".tool-button").each(function(e,t){$(t).triggerHandler("updateInterface")})};n=__decorate([e.Decorators.registerClass("Serenity.Toolbar")],n);return n}(e.Widget);e.Toolbar=r})(Serenity||(Serenity={}));var Serenity;(function(e){var t;(function(t){function n(e){var t=e.element.data("select2");if(t!=null){var n=e.element.select2("data");if(n==null)return"";return Q.coalesce(n.text,"")}var r=i(e);if(r==null){return""}if(typeof r==="string")return r;if(r instanceof Boolean)return!!r?Q.coalesce(Q.tryGetText("Controls.FilterPanel.OperatorNames.true"),"True"):Q.coalesce(Q.tryGetText("Controls.FilterPanel.OperatorNames.true"),"False");return r.toString()}t.getDisplayText=n;var r={name:"_"};function i(e){var t={};a(e,r,t);return t["_"]}t.getValue=i;function a(t,n,r){var i=Q.safeCast(t,e.IGetEditValue);if(i!=null){i.getEditValue(n,r);return}var a=Q.safeCast(t,e.IStringValue);if(a!=null){r[n.name]=a.get_value();return}var o=Q.safeCast(t,e.IBooleanValue);if(o!=null){r[n.name]=o.get_value();return}var u=Q.safeCast(t,e.IDoubleValue);if(u!=null){var l=u.get_value();r[n.name]=isNaN(l)?null:l;return}if(t.getEditValue!=null){t.getEditValue(n,r);return}if(t.element.is(":input")){r[n.name]=t.element.val();return}}t.saveValue=a;function o(e,t){var n={_:t};u(e,r,n)}t.setValue=o;function u(t,n,r){var i=Q.safeCast(t,e.ISetEditValue);if(i!=null){i.setEditValue(r,n);return}var a=Q.safeCast(t,e.IStringValue);if(a!=null){var o=r[n.name];if(o!=null){o=o.toString()}a.set_value(Q.cast(o,String));return}var u=Q.safeCast(t,e.IBooleanValue);if(u!=null){var l=r[n.name];if(typeof l==="number"){u.set_value(l>0)}else{u.set_value(!!l)}return}var s=Q.safeCast(t,e.IDoubleValue);if(s!=null){var f=r[n.name];if(!!(f==null||Q.isInstanceOfType(f,String)&&Q.isTrimmedEmpty(Q.cast(f,String)))){s.set_value(null)}else if(Q.isInstanceOfType(f,String)){s.set_value(Q.cast(Q.parseDecimal(Q.cast(f,String)),Number))}else if(Q.isInstanceOfType(f,Boolean)){s.set_value(!!f?1:0)}else{s.set_value(Q.cast(f,Number))}return}if(t.setEditValue!=null){t.setEditValue(r,n);return}if(t.element.is(":input")){var c=r[n.name];if(c==null){t.element.val("")}else{t.element.val(c)}return}}t.loadValue=u;function l(e,t){e.each(function(e,n){var r=$(n);var i=r.attr("type");if(r.is("select")||i==="radio"||i==="checkbox"){if(t){r.addClass("readonly").attr("disabled","disabled")}else{r.removeClass("readonly").removeAttr("disabled")}}else if(t){r.addClass("readonly").attr("readonly","readonly")}else{r.removeClass("readonly").removeAttr("readonly")}return true});return e}t.setReadonly=l;function s(t,n){var r=Q.safeCast(t,e.IReadOnly);if(r!=null){r.set_readOnly(n)}else if(t.element.is(":input")){l(t.element,n)}}t.setReadOnly=s;function f(t,n){var r=Q.safeCast(t,e.IValidateRequired);if(r!=null){r.set_required(n)}else if(t.element.is(":input")){t.element.toggleClass("required",!!n)}var i=t.element.closest(".field");var a=i.find("sup").get().length>0;if(n&&!a){$("<sup>*</sup>").attr("title",Q.text("Controls.PropertyGrid.RequiredHint")).prependTo(i.find(".caption")[0])}else if(!n&&a){$(i.find("sup")[0]).remove()}}t.setRequired=f;function c(t,n){if(!n){if(!t.hasClass("readonly-container"))return;t.removeClass("readonly-container").find(".editor.container-readonly").removeClass("container-readonly").each(function(t,n){var r=$(n).tryGetWidget(e.Widget);if(r!=null)e.EditorUtils.setReadOnly(r,false);else e.EditorUtils.setReadonly($(n),false)});return}t.addClass("readonly-container").find(".editor").not(".container-readonly").each(function(t,n){var r=$(n).tryGetWidget(e.Widget);if(r!=null){if(r["get_readOnly"]){if(r["get_readOnly"]())return}else if($(n).is("[readonly]")||$(n).is("[disabled]")||$(n).is(".readonly")||$(n).is(".disabled"))return;$(n).addClass("container-readonly");e.EditorUtils.setReadOnly(r,true)}else{if($(n).is("[readonly]")||$(n).is("[disabled]")||$(n).is(".readonly")||$(n).is(".disabled"))return;e.EditorUtils.setReadonly($(n).addClass("container-readonly"),true)}})}t.setContainerReadOnly=c})(t=e.EditorUtils||(e.EditorUtils={}))
})(Serenity||(Serenity={}));var Serenity;(function(e){var t;(function(e){var t=0;function n(e,t){var n=e&&e[0];if(!n)return;if(n.offsetWidth>0&&n.offsetHeight>0){t();return}var r=Q.LayoutTimer.onShown(function(){return n},function(){Q.LayoutTimer.off(r);t()})}e.executeOnceWhenShown=n;function r(e,t,n){var r=e&&e[0];if(!r)return;if(n&&r.offsetWidth>0&&r.offsetHeight>0){t()}Q.LayoutTimer.onShown(function(){return r},function(){t()})}e.executeEverytimeWhenShown=r})(t=e.LazyLoadHelper||(e.LazyLoadHelper={}))})(Serenity||(Serenity={}));var Serenity;(function(e){var t;(function(e){function t(e,t,n,r){var i=t.widgetName;e.element.bind("ondatachange."+i,function(e,t){if(r){window.setTimeout(function(){n(e,t)},0)}else{n(e,t)}}).bind("remove."+i,function(){e.element.unbind("ondatachange."+i)});return e}e.bindToDataChange=t;function n(e){e.element.triggerHandler("ondatachange");return e}e.triggerDataChange=n;function r(e){e.triggerHandler("ondatachange");return e}e.triggerDataChanged=r;function i(e,n,r){return t(e,n,function(e,t){n.element.triggerHandler("ondatachange")},r)}e.bubbleDataChange=i;function a(e,t){e.element.one("dialogopen",function(n){e.element.dialog().dialog("option","position",o(t))});return e}e.cascade=a;function o(e){return{my:"left top",at:"left+20 top+20",of:e[0]}}e.cascadedDialogOffset=o})(t=e.SubDialogHelper||(e.SubDialogHelper={}))})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function e(e){this.idPrefix=e}e.prototype.byId=function(e){return $("#"+this.idPrefix+e)};e.prototype.w=function(e,t){return $("#"+this.idPrefix+e).getWidget(t)};return e}();e.PrefixedContext=t})(Serenity||(Serenity={}));var Serenity;(function(e){function t(){if(typeof $=="undefined"||!$.ui||!$.ui.dialog||!$.ui.dialog.prototype)return false;$.ui.dialog.prototype._allowInteraction=function(e){if($(e.target).closest(".ui-dialog").length){return true}return!!$(e.target).closest(".ui-datepicker, .select2-drop, .cke, .cke_dialog, #support-modal").length};(function(e){$.ui.dialog.prototype._focusTabbable=function(){if($(document.body).hasClass("mobile-device")){this.uiDialog&&this.uiDialog.focus();return}e.call(this)}})($.ui.dialog.prototype._focusTabbable);(function(e){$.ui.dialog.prototype._createTitlebar=function(){e.call(this);this.uiDialogTitlebar.find(".ui-dialog-titlebar-close").html('<i class="fa fa-times" />')}})($.ui.dialog.prototype._createTitlebar)}!t()&&typeof $!=="undefined"&&$(t);if(typeof $!=="undefined"){$.cleanData=function(e){return function(t){var n,r,i,a;var o=t;for(i=0;(r=o[i])!=null;i++){try{n=$._data(r,"events");if(n&&n.remove){if(o===t)o=Array.prototype.slice.call(t);$(r).triggerHandler("remove");delete n.remove}}catch(a){}}e(t)}}($.cleanData)}})(Serenity||(Serenity={}));